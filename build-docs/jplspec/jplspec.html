<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>JPL Spectroscopy Queries (astroquery.jplspec) &#8212; astroquery v0.4.7.dev9024</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../_static/bootstrap-astropy.css?v=9d21690f" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    
    <script src="../_static/jquery.js?v=5d32c60e"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../_static/documentation_options.js?v=4195d067"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="JPLSpecClass" href="../api/astroquery.jplspec.JPLSpecClass.html" />
    <link rel="prev" title="Conf" href="../api/astroquery.ipac.irsa.Conf.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">query</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../api/astroquery.jplspec.JPLSpecClass.html" title="JPLSpecClass">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../api/astroquery.ipac.irsa.Conf.html" title="Conf">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">astroquery v0.4.7.dev9024</a>
	 &#187;
      </li>
      
      <li>JPL Spectroscopy Queries (astroquery.jplspec)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <section id="jpl-spectroscopy-queries-astroquery-jplspec">
<span id="astroquery-jplspec"></span><h1>JPL Spectroscopy Queries (astroquery.jplspec)<a class="headerlink" href="#jpl-spectroscopy-queries-astroquery-jplspec" title="Link to this heading">¶</a></h1>
<section id="getting-started">
<h2>Getting Started<a class="headerlink" href="#getting-started" title="Link to this heading">¶</a></h2>
<p>The JPLSpec module provides a query interface for <a class="reference external" href="https://spec.jpl.nasa.gov/home.html">JPL Molecular
Spectroscopy Catalog</a>. The
module outputs the results that would arise from the <a class="reference external" href="https://spec.jpl.nasa.gov/ftp/pub/catalog/catform.html">browser form</a>,
using similar search criteria as the ones found in the form, and presents
the output as a <a class="reference external" href="https://docs.astropy.org/en/latest/api/astropy.table.Table.html#astropy.table.Table" title="(in Astropy v6.1)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Table</span></code></a>.</p>
</section>
<section id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Link to this heading">¶</a></h2>
<section id="querying-the-catalog">
<h3>Querying the catalog<a class="headerlink" href="#querying-the-catalog" title="Link to this heading">¶</a></h3>
<p>The default option to return the query payload is set to false, in the
following examples we have explicitly set it to False and True to show the
what each setting yields:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astroquery.jplspec</span> <span class="kn">import</span> <span class="n">JPLSpec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">query_lines</span><span class="p">(</span><span class="n">min_frequency</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">max_frequency</span><span class="o">=</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">min_strength</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;28001 CO&quot;</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="go">    FREQ     ERR    LGINT   DR   ELO   GUP  TAG   QNFMT QN&#39; QN&quot;</span>
<span class="go">    MHz      MHz   nm2 MHz      1 / cm</span>
<span class="go">----------- ------ ------- --- -------- --- ------ ----- --- ---</span>
<span class="go">115271.2018 0.0005 -5.0105   2      0.0   3 -28001   101   1   0</span>
<span class="go">   230538.0 0.0005 -4.1197   2    3.845   5 -28001   101   2   1</span>
<span class="go">345795.9899 0.0005 -3.6118   2   11.535   7 -28001   101   3   2</span>
<span class="go">461040.7682 0.0005 -3.2657   2  23.0695   9 -28001   101   4   3</span>
<span class="go">576267.9305 0.0005 -3.0118   2  38.4481  11 -28001   101   5   4</span>
<span class="go">691473.0763 0.0005 -2.8193   2  57.6704  13 -28001   101   6   5</span>
<span class="go"> 806651.806  0.005 -2.6716   2  80.7354  15 -28001   101   7   6</span>
<span class="go">   921799.7  0.005  -2.559   2 107.6424  17 -28001   101   8   7</span>
</pre></div>
</div>
<p>The following example, with <code class="docutils literal notranslate"><span class="pre">get_query_payload</span> <span class="pre">=</span> <span class="pre">True</span></code>, returns the payload:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">query_lines</span><span class="p">(</span><span class="n">min_frequency</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">max_frequency</span><span class="o">=</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">min_strength</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;28001 CO&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                  <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
<span class="go">[(&#39;MinNu&#39;, 100.0), (&#39;MaxNu&#39;, 1000.0), (&#39;MaxLines&#39;, 2000), (&#39;UnitNu&#39;, &#39;GHz&#39;), (&#39;StrLim&#39;, -500), (&#39;Mol&#39;, &#39;28001 CO&#39;)]</span>
</pre></div>
</div>
<p>The units of the columns of the query can be displayed by calling
<code class="docutils literal notranslate"><span class="pre">response.info</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">response</span> <span class="o">=</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">query_lines</span><span class="p">(</span><span class="n">min_frequency</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">max_frequency</span><span class="o">=</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">min_strength</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;28001 CO&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">info</span><span class="p">)</span>
<span class="go">   &lt;Table length=8&gt;</span>
<span class="go">  name  dtype    unit</span>
<span class="go"> ----- ------- -------</span>
<span class="go">  FREQ float64     MHz</span>
<span class="go">   ERR float64     MHz</span>
<span class="go"> LGINT float64 nm2 MHz</span>
<span class="go">    DR   int64</span>
<span class="go">   ELO float64  1 / cm</span>
<span class="go">   GUP   int64</span>
<span class="go">   TAG   int64</span>
<span class="go"> QNFMT   int64</span>
<span class="go">   QN&#39;   int64</span>
<span class="go">   QN&quot;   int64</span>
</pre></div>
</div>
<p>These come in handy for converting to other units easily, an example using a
simplified version of the data above is shown below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span> <span class="p">(</span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;FREQ&#39;</span><span class="p">,</span> <span class="s1">&#39;ERR&#39;</span><span class="p">,</span> <span class="s1">&#39;ELO&#39;</span><span class="p">])</span>
<span class="go">    FREQ     ERR     ELO</span>
<span class="go">    MHz      MHz    1 / cm</span>
<span class="go">----------- ------ --------</span>
<span class="go">115271.2018 0.0005      0.0</span>
<span class="go">   230538.0 0.0005    3.845</span>
<span class="go">345795.9899 0.0005   11.535</span>
<span class="go">461040.7682 0.0005  23.0695</span>
<span class="go">576267.9305 0.0005  38.4481</span>
<span class="go">691473.0763 0.0005  57.6704</span>
<span class="go"> 806651.806  0.005  80.7354</span>
<span class="go">   921799.7  0.005 107.6424</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;FREQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">quantity</span>
<span class="go">&lt;Quantity [115271.2018, 230538.    , 345795.9899, 461040.7682, 576267.9305, 691473.0763, 806651.806 , 921799.7   ] MHz&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">response</span><span class="p">[</span><span class="s1">&#39;FREQ&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;GHz&#39;</span><span class="p">)</span>
<span class="go">&lt;Quantity [115.2712018, 230.538    , 345.7959899, 461.0407682, 576.2679305, 691.4730763, 806.651806 , 921.7997   ] GHz&gt;</span>
</pre></div>
</div>
<p>The parameters and response keys are described in detail under the
Reference/API section.</p>
</section>
<section id="looking-up-more-information-from-the-catdir-cat-file">
<h3>Looking Up More Information from the catdir.cat file<a class="headerlink" href="#looking-up-more-information-from-the-catdir-cat-file" title="Link to this heading">¶</a></h3>
<p>If you have found a molecule you are interested in, the TAG field
in the results provides enough information to access specific
molecule information such as the partition functions at different
temperatures. Keep in mind that a negative TAG value signifies that
the line frequency has been measured in the laboratory</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astroquery.jplspec</span> <span class="kn">import</span> <span class="n">JPLSpec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">get_species_table</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mol</span> <span class="o">=</span> <span class="n">result</span><span class="p">[</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;TAG&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="mi">28001</span><span class="p">]</span> <span class="c1">#do not include signs of TAG for this</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">mol</span><span class="p">)</span>
<span class="go"> TAG  NAME NLINE QLOG1  QLOG2  QLOG3 QLOG4  QLOG5  QLOG6  QLOG7  VER</span>
<span class="go">----- ---- ----- ------ ------ ----- ------ ------ ------ ------ ---</span>
<span class="go">28001   CO    91 2.0369 1.9123 1.737 1.4386 1.1429 0.8526 0.5733  4*</span>
</pre></div>
</div>
<p>You can also access the temperature of the partition function
through metadata:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;QLOG2&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">meta</span>
<span class="go">{&#39;Temperature (K)&#39;: 225}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span><span class="o">.</span><span class="n">meta</span>
<span class="go">{&#39;Temperature (K)&#39;: [300, 225, 150, 75, 37.5, 18.5,</span>
<span class="go">                     9.375]}</span>
</pre></div>
</div>
<p>One of the advantages of using JPLSpec is the availability in the catalog
of the partition function at different temperatures for the molecules. As a
continuation of the example above, an example that accesses and plots the
partition function against the temperatures found in the metadata is shown
below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">temp</span> <span class="o">=</span> <span class="n">result</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">part</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">mol</span><span class="p">[</span><span class="s1">&#39;QLOG1&#39;</span><span class="p">,</span><span class="s1">&#39;QLOG2&#39;</span><span class="p">,</span><span class="s1">&#39;QLOG3&#39;</span><span class="p">,</span> <span class="s1">&#39;QLOG4&#39;</span><span class="p">,</span> <span class="s1">&#39;QLOG5&#39;</span><span class="p">,</span><span class="s1">&#39;QLOG6&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="s1">&#39;QLOG7&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">part</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature (K)&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Partition Function Value&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Parititon Fn vs Temp&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id1">
<a class="reference internal image-reference" href="../_images/docplot_jplspec.png"><img alt="Plot of Partition Function vs Temperature" src="../_images/docplot_jplspec.png" style="width: 320.0px; height: 240.0px;" /></a>
<figcaption>
<p><span class="caption-text">The resulting plot from the example above</span><a class="headerlink" href="#id1" title="Link to this image">¶</a></p>
</figcaption>
</figure>
<p>For non-linear molecules like H2O, curve fitting methods can be used to
calculate production rates at different temperatures with the proportionality:
<code class="docutils literal notranslate"><span class="pre">a*T**(3./2.)</span></code>. Calling the process above for the H2O molecule (instead of
for the CO molecule) we can continue to determine the partition function at
other temperatures using curve fitting models:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">curve_fit</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">T</span><span class="p">,</span><span class="n">a</span><span class="p">):</span>
<span class="go">        return np.log10(a*T**(1.5))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">param</span><span class="p">,</span> <span class="n">cov</span> <span class="o">=</span> <span class="n">curve_fit</span><span class="p">(</span><span class="n">f</span><span class="p">,</span><span class="n">temp</span><span class="p">,</span><span class="n">part</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">param</span><span class="p">)</span>
<span class="go"># array([0.03676998])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">305</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">y</span> <span class="o">=</span> <span class="n">f</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="mf">0.03676998</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">temp</span><span class="p">,</span><span class="n">part</span><span class="p">,</span><span class="n">c</span><span class="o">=</span><span class="s1">&#39;r&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="s1">&#39;k&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s1">&#39;Partition Function vs Temperature&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Temperature&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;Log10 of Partition Function&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../_images/docplot_curvefit.png"><img alt="Plot of Partition Function vs Temperature and resulting Curve Fit" src="../_images/docplot_curvefit.png" style="width: 320.0px; height: 234.0px;" /></a>
<figcaption>
<p><span class="caption-text">The resulting plot from the example above</span><a class="headerlink" href="#id2" title="Link to this image">¶</a></p>
</figcaption>
</figure>
</section>
<section id="querying-the-catalog-with-regexes-and-relative-names">
<h3>Querying the Catalog with Regexes and Relative names<a class="headerlink" href="#querying-the-catalog-with-regexes-and-relative-names" title="Link to this heading">¶</a></h3>
<p>Although you could print the species table and see what molecules you’re
interested in, maybe you just want a general search of any H2O molecule,
or maybe you want a specific range of H2O molecules in your result. This
module allows you to enter a regular expression or string as a parameter
by adding the parameter <code class="docutils literal notranslate"><span class="pre">parse_name_locally</span> <span class="pre">=</span> <span class="pre">True</span></code> and returns the results
that the regex matched with by parsing through the local catalog file. It is
recommended that if you are using just the corresponding molecule number found
in the JPL query catalog or a string with the exact name found in the catalog,
that you do not set the local parse parameter since the module will be able
to query these directly.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astroquery.jplspec</span> <span class="kn">import</span> <span class="n">JPLSpec</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">query_lines</span><span class="p">(</span><span class="n">min_frequency</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">max_frequency</span><span class="o">=</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">min_strength</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;H2O&quot;</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">parse_name_locally</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="p">)</span>
<span class="go">    FREQ      ERR     LGINT    DR    ELO    GUP  TAG   QNFMT   QN&#39;      QN&quot;</span>
<span class="go">    MHz       MHz    nm2 MHz        1 / cm</span>
<span class="go">----------- -------- -------- --- --------- --- ------ ----- -------- --------</span>
<span class="go">115542.5692   0.6588 -13.2595   3 4606.1683  35  18003  1404 17 810 0 18 513 0</span>
<span class="go"> 139614.293     0.15  -9.3636   3 3080.1788  87 -18003  1404 14 6 9 0 15 312 0</span>
<span class="go"> 177317.068     0.15 -10.3413   3 3437.2774  31 -18003  1404 15 610 0 16 313 0</span>
<span class="go"> 183310.087    0.001  -3.6463   3  136.1639   7 -18003  1404  3 1 3 0  2 2 0 0</span>
<span class="go">...</span>
<span class="go">Length = 2000 rows</span>
</pre></div>
</div>
<p>Searches like these can lead to very broad queries, and may be limited in
response length:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">result</span><span class="o">.</span><span class="n">meta</span><span class="p">[</span><span class="s1">&#39;comments&#39;</span><span class="p">])</span>
<span class="go">[&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;form is currently limilted to 2000 lines. Please limit your search.&#39;]</span>
</pre></div>
</div>
<p>Inspecting the returned molecules shows that the ‘H2O’ string was processed as a
regular expression, and the search matched any molecule that contained the
combination of characters ‘H2O’:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;TAG&#39;</span><span class="p">]))</span>  <span class="c1"># discard negative signs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="p">{</span><span class="n">species</span><span class="p">:</span> <span class="n">tag</span>
<span class="gp">... </span>           <span class="k">for</span> <span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span> <span class="ow">in</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">lookup_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="gp">... </span>           <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
<span class="go">{&#39;H2O&#39;: 18003, &#39;H2O v2,2v2,v&#39;: 18005, &#39;H2O-17&#39;: 19003, &#39;H2O-18&#39;: 20003, &#39;H2O2&#39;: 34004}</span>
</pre></div>
</div>
<p>A few examples that show the power of the regex option are the following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">query_lines</span><span class="p">(</span><span class="n">min_frequency</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">max_frequency</span><span class="o">=</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">min_strength</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;H2O$&quot;</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">parse_name_locally</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;TAG&#39;</span><span class="p">]))</span>  <span class="c1"># discard negative signs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="p">{</span><span class="n">species</span><span class="p">:</span> <span class="n">tag</span>
<span class="gp">... </span>           <span class="k">for</span> <span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span> <span class="ow">in</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">lookup_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="gp">... </span>           <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
<span class="go">{&#39;H2O&#39;: 18003}</span>
</pre></div>
</div>
<p>As seen above, the regular expression “H2O$” yields only an exact match because
the special character $ matches the end of the line. This functionality allows
you to be as specific or vague as you want to allow the results to be:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">query_lines</span><span class="p">(</span><span class="n">min_frequency</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">max_frequency</span><span class="o">=</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">min_strength</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">molecule</span><span class="o">=</span><span class="s2">&quot;^H.O$&quot;</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">parse_name_locally</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;TAG&#39;</span><span class="p">]))</span>  <span class="c1"># discard negative signs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="p">{</span><span class="n">species</span><span class="p">:</span> <span class="n">tag</span>
<span class="gp">... </span>           <span class="k">for</span> <span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span> <span class="ow">in</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">lookup_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="gp">... </span>           <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
<span class="go">{&#39;H2O&#39;: 18003, &#39;HDO&#39;: 19002, &#39;HCO&#39;: 29004, &#39;HNO&#39;: 31005}</span>
</pre></div>
</div>
<p>This pattern matches any word that starts with an H, ends with an O, and
contains any character in between.</p>
<p>Another example of the functionality of this option is the option to obtain
results from a molecule and its isotopes, in this case H2O and HDO:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">result</span> <span class="o">=</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">query_lines</span><span class="p">(</span><span class="n">min_frequency</span><span class="o">=</span><span class="mi">100</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">max_frequency</span><span class="o">=</span><span class="mi">1000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">GHz</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">min_strength</span><span class="o">=-</span><span class="mi">500</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">molecule</span><span class="o">=</span><span class="sa">r</span><span class="s2">&quot;^H[2D]O(-\d\d|)$&quot;</span><span class="p">,</span>
<span class="gp">... </span>                             <span class="n">parse_name_locally</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tags</span> <span class="o">=</span> <span class="nb">set</span><span class="p">(</span><span class="nb">abs</span><span class="p">(</span><span class="n">result</span><span class="p">[</span><span class="s1">&#39;TAG&#39;</span><span class="p">]))</span>  <span class="c1"># discard negative signs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">species</span> <span class="o">=</span> <span class="p">{</span><span class="n">species</span><span class="p">:</span> <span class="n">tag</span>
<span class="gp">... </span>           <span class="k">for</span> <span class="p">(</span><span class="n">species</span><span class="p">,</span> <span class="n">tag</span><span class="p">)</span> <span class="ow">in</span> <span class="n">JPLSpec</span><span class="o">.</span><span class="n">lookup_ids</span><span class="o">.</span><span class="n">items</span><span class="p">()</span>
<span class="gp">... </span>           <span class="k">if</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">species</span><span class="p">)</span>
<span class="go">{&#39;H2O&#39;: 18003, &#39;HDO&#39;: 19002, &#39;H2O-17&#39;: 19003, &#39;H2O-18&#39;: 20003, &#39;HDO-18&#39;: 21001}</span>
</pre></div>
</div>
<p>This pattern matches any H2O and HDO isotopes.</p>
</section>
</section>
<section id="reference-api">
<h2>Reference/API<a class="headerlink" href="#reference-api" title="Link to this heading">¶</a></h2>
<section id="module-astroquery.jplspec">
<span id="astroquery-jplspec-package"></span><h3>astroquery.jplspec Package<a class="headerlink" href="#module-astroquery.jplspec" title="Link to this heading">¶</a></h3>
<section id="jpl-spectral-catalog">
<h4>JPL Spectral Catalog<a class="headerlink" href="#jpl-spectral-catalog" title="Link to this heading">¶</a></h4>
<dl class="field-list simple">
<dt class="field-odd">author<span class="colon">:</span></dt>
<dd class="field-odd"><p>Giannina Guzman (<a class="reference external" href="mailto:gguzman2&#37;&#52;&#48;villanova&#46;edu">gguzman2<span>&#64;</span>villanova<span>&#46;</span>edu</a>)</p>
</dd>
<dt class="field-even">author<span class="colon">:</span></dt>
<dd class="field-even"><p>Miguel de Val-Borro (<a class="reference external" href="mailto:miguel&#46;deval&#37;&#52;&#48;gmail&#46;com">miguel<span>&#46;</span>deval<span>&#64;</span>gmail<span>&#46;</span>com</a>)</p>
</dd>
</dl>
</section>
<section id="classes">
<h4>Classes<a class="headerlink" href="#classes" title="Link to this heading">¶</a></h4>
<table class="autosummary longtable docutils align-default">
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="../api/astroquery.jplspec.JPLSpecClass.html#astroquery.jplspec.JPLSpecClass" title="astroquery.jplspec.JPLSpecClass"><code class="xref py py-obj docutils literal notranslate"><span class="pre">JPLSpecClass</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="../api/astroquery.jplspec.Conf.html#astroquery.jplspec.Conf" title="astroquery.jplspec.Conf"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Conf</span></code></a>()</p></td>
<td><p>Configuration parameters for <a class="reference internal" href="#module-astroquery.jplspec" title="astroquery.jplspec"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astroquery.jplspec</span></code></a>.</p></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">JPL Spectroscopy Queries (astroquery.jplspec)</a><ul>
<li><a class="reference internal" href="#getting-started">Getting Started</a></li>
<li><a class="reference internal" href="#examples">Examples</a><ul>
<li><a class="reference internal" href="#querying-the-catalog">Querying the catalog</a></li>
<li><a class="reference internal" href="#looking-up-more-information-from-the-catdir-cat-file">Looking Up More Information from the catdir.cat file</a></li>
<li><a class="reference internal" href="#querying-the-catalog-with-regexes-and-relative-names">Querying the Catalog with Regexes and Relative names</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reference-api">Reference/API</a><ul>
<li><a class="reference internal" href="#module-astroquery.jplspec">astroquery.jplspec Package</a><ul>
<li><a class="reference internal" href="#jpl-spectral-catalog">JPL Spectral Catalog</a></li>
<li><a class="reference internal" href="#classes">Classes</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/jplspec/jplspec.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, The Astroquery Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 11 Dec 2023. <br/>
  </p>
</footer>
  </body>
</html>