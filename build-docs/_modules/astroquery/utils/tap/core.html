<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>astroquery.utils.tap.core &#8212; astroquery v0.4.7.dev9024</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/bootstrap-astropy.css?v=9d21690f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    
    <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../../_static/documentation_options.js?v=4195d067"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../index.html"><span id="logotext1">astro</span><span id="logotext2">query</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../index.html">astroquery v0.4.7.dev9024</a>
	 &#187;
      </li>
      <li><a href="../../../index.html" accesskey="U">Module code</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for astroquery.utils.tap.core</h1><div class="highlight"><pre>
<span></span><span class="c1"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">=============</span>
<span class="sd">TAP plus</span>
<span class="sd">=============</span>

<span class="sd">@author: Juan Carlos Segovia</span>
<span class="sd">@contact: juan.carlos.segovia@sciops.esa.int</span>

<span class="sd">European Space Astronomy Centre (ESAC)</span>
<span class="sd">European Space Agency (ESA)</span>

<span class="sd">Created on 30 jun. 2016</span>
<span class="sd">Modified on 1 jun. 2021 by mhsarmiento</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">urllib.parse</span> <span class="kn">import</span> <span class="n">urlencode</span>

<span class="kn">from</span> <span class="nn">astroquery.utils.tap</span> <span class="kn">import</span> <span class="n">taputils</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.conn.tapconn</span> <span class="kn">import</span> <span class="n">TapConn</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.xmlparser.tableSaxParser</span> <span class="kn">import</span> <span class="n">TableSaxParser</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.model.job</span> <span class="kn">import</span> <span class="n">Job</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.gui.login</span> <span class="kn">import</span> <span class="n">LoginDialog</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.xmlparser.jobSaxParser</span> <span class="kn">import</span> <span class="n">JobSaxParser</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.xmlparser.jobListSaxParser</span> <span class="kn">import</span> <span class="n">JobListSaxParser</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.xmlparser.groupSaxParser</span> <span class="kn">import</span> <span class="n">GroupSaxParser</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.xmlparser.sharedItemsSaxParser</span> <span class="kn">import</span> <span class="n">SharedItemsSaxParser</span>  <span class="c1"># noqa</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.xmlparser</span> <span class="kn">import</span> <span class="n">utils</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap.model.filter</span> <span class="kn">import</span> <span class="n">Filter</span>
<span class="kn">import</span> <span class="nn">requests</span>
<span class="kn">from</span> <span class="nn">astroquery</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">import</span> <span class="nn">getpass</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">astropy.table.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">import</span> <span class="nn">tempfile</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Tap&#39;</span><span class="p">,</span> <span class="s1">&#39;TapPlus&#39;</span><span class="p">]</span>

<span class="n">VERSION</span> <span class="o">=</span> <span class="s2">&quot;20200428.1&quot;</span>


<div class="viewcode-block" id="Tap">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.Tap.html#astroquery.utils.tap.Tap">[docs]</a>
<span class="k">class</span> <span class="nc">Tap</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TAP class</span>
<span class="sd">    Provides TAP capabilities</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">server_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">tap_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">sslport</span><span class="o">=</span><span class="mi">443</span><span class="p">,</span>
                 <span class="n">default_protocol_is_https</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">connhandler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">upload_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">table_edit_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">data_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">datalink_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        url : str, mandatory if no host is specified, default None</span>
<span class="sd">            TAP URL</span>
<span class="sd">        host : str, optional, default None</span>
<span class="sd">            host name</span>
<span class="sd">        server_context : str, mandatory, default None</span>
<span class="sd">            server context</span>
<span class="sd">        tap_context : str, mandatory, default None</span>
<span class="sd">            tap context</span>
<span class="sd">        upload_context : str, optional, default None</span>
<span class="sd">            upload context</span>
<span class="sd">        table_edit_context : str, mandatory, default None</span>
<span class="sd">            context for all actions to be performed over a existing table</span>
<span class="sd">        data_context : str, optional, default None</span>
<span class="sd">            data context</span>
<span class="sd">        datalink_context : str, optional, default None</span>
<span class="sd">            datalink context</span>
<span class="sd">        port : int, optional, default &#39;80&#39;</span>
<span class="sd">            HTTP port</span>
<span class="sd">        sslport : int, optional, default &#39;443&#39;</span>
<span class="sd">            HTTPS port</span>
<span class="sd">        default_protocol_is_https : bool, optional, default False</span>
<span class="sd">            Specifies whether the default protocol to be used is HTTPS</span>
<span class="sd">        connhandler : connection handler object, optional, default None</span>
<span class="sd">            HTTP(s) connection hander (creator). If no handler is provided, a</span>
<span class="sd">            new one is created.</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__internalInit</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">url</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">protocol</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">server</span><span class="p">,</span> <span class="n">tap</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__parseUrl</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">server_context</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">server_context</span> <span class="o">=</span> <span class="n">server</span>
            <span class="k">if</span> <span class="n">tap_context</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">tap_context</span> <span class="o">=</span> <span class="n">tap</span>
            <span class="k">if</span> <span class="n">protocol</span> <span class="o">==</span> <span class="s2">&quot;http&quot;</span><span class="p">:</span>
                <span class="n">tap</span> <span class="o">=</span> <span class="n">TapConn</span><span class="p">(</span><span class="n">ishttps</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                              <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
                              <span class="n">server_context</span><span class="o">=</span><span class="n">server_context</span><span class="p">,</span>
                              <span class="n">tap_context</span><span class="o">=</span><span class="n">tap_context</span><span class="p">,</span>
                              <span class="n">upload_context</span><span class="o">=</span><span class="n">upload_context</span><span class="p">,</span>
                              <span class="n">table_edit_context</span><span class="o">=</span><span class="n">table_edit_context</span><span class="p">,</span>
                              <span class="n">data_context</span><span class="o">=</span><span class="n">data_context</span><span class="p">,</span>
                              <span class="n">datalink_context</span><span class="o">=</span><span class="n">datalink_context</span><span class="p">,</span>
                              <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                              <span class="n">sslport</span><span class="o">=</span><span class="n">sslport</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span> <span class="o">=</span> <span class="n">tap</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># https port -&gt; sslPort</span>
                <span class="n">tap</span> <span class="o">=</span> <span class="n">TapConn</span><span class="p">(</span><span class="n">ishttps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                              <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
                              <span class="n">server_context</span><span class="o">=</span><span class="n">server_context</span><span class="p">,</span>
                              <span class="n">tap_context</span><span class="o">=</span><span class="n">tap_context</span><span class="p">,</span>
                              <span class="n">upload_context</span><span class="o">=</span><span class="n">upload_context</span><span class="p">,</span>
                              <span class="n">table_edit_context</span><span class="o">=</span><span class="n">table_edit_context</span><span class="p">,</span>
                              <span class="n">data_context</span><span class="o">=</span><span class="n">data_context</span><span class="p">,</span>
                              <span class="n">datalink_context</span><span class="o">=</span><span class="n">datalink_context</span><span class="p">,</span>
                              <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                              <span class="n">sslport</span><span class="o">=</span><span class="n">port</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span> <span class="o">=</span> <span class="n">tap</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">tap</span> <span class="o">=</span> <span class="n">TapConn</span><span class="p">(</span><span class="n">ishttps</span><span class="o">=</span><span class="n">default_protocol_is_https</span><span class="p">,</span>
                          <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
                          <span class="n">server_context</span><span class="o">=</span><span class="n">server_context</span><span class="p">,</span>
                          <span class="n">tap_context</span><span class="o">=</span><span class="n">tap_context</span><span class="p">,</span>
                          <span class="n">upload_context</span><span class="o">=</span><span class="n">upload_context</span><span class="p">,</span>
                          <span class="n">table_edit_context</span><span class="o">=</span><span class="n">table_edit_context</span><span class="p">,</span>
                          <span class="n">data_context</span><span class="o">=</span><span class="n">data_context</span><span class="p">,</span>
                          <span class="n">datalink_context</span><span class="o">=</span><span class="n">datalink_context</span><span class="p">,</span>
                          <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span>
                          <span class="n">sslport</span><span class="o">=</span><span class="n">sslport</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span> <span class="o">=</span> <span class="n">tap</span>
        <span class="c1"># if connectionHandler is set, use it (useful for testing)</span>
        <span class="k">if</span> <span class="n">connhandler</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span> <span class="o">=</span> <span class="n">connhandler</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created TAP+ (v</span><span class="si">{</span><span class="n">VERSION</span><span class="si">}</span><span class="s2">) - Connection:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__internalInit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">tap_client_id</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;aqtappy1-</span><span class="si">{</span><span class="n">VERSION</span><span class="si">}</span><span class="s2">&quot;</span>

<div class="viewcode-block" id="Tap.load_tables">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.Tap.html#astroquery.utils.tap.Tap.load_tables">[docs]</a>
    <span class="k">def</span> <span class="nf">load_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads all public tables</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of table objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__load_tables</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


<div class="viewcode-block" id="Tap.load_table">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.Tap.html#astroquery.utils.tap.Tap.load_table">[docs]</a>
    <span class="k">def</span> <span class="nf">load_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the specified table</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table : str, mandatory</span>
<span class="sd">            full qualified table name (i.e. schema name + table name)</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A table object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table name is required&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Retrieving table &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tables?tables=</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span>
                                                     <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                        <span class="n">verbose</span><span class="p">,</span>
                                                        <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Parsing table &#39;</span><span class="si">{</span><span class="n">table</span><span class="si">}</span><span class="s2">&#39;...&quot;</span><span class="p">)</span>
        <span class="n">tsp</span> <span class="o">=</span> <span class="n">TableSaxParser</span><span class="p">()</span>
        <span class="n">tsp</span><span class="o">.</span><span class="n">parseData</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tsp</span><span class="o">.</span><span class="n">get_table</span><span class="p">()</span></div>


    <span class="k">def</span> <span class="nf">__load_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">only_names</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_shared_tables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads all public tables</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        only_names : bool, TAP+ only, optional, default &#39;False&#39;</span>
<span class="sd">            True to load table names only</span>
<span class="sd">        include_shared_tables : bool, TAP+, optional, default &#39;False&#39;</span>
<span class="sd">            True to include shared tables</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of table objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># share_info=true&amp;share_accessible=true&amp;only_tables=true</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">addedItem</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">only_names</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s2">&quot;only_tables=true&quot;</span>
            <span class="n">addedItem</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">if</span> <span class="n">include_shared_tables</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">addedItem</span><span class="p">:</span>
                <span class="n">flags</span> <span class="o">+=</span> <span class="s2">&quot;&amp;&quot;</span>
            <span class="n">flags</span> <span class="o">+=</span> <span class="s2">&quot;share_accessible=true&quot;</span>
            <span class="n">addedItem</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Retrieving tables...&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">flags</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tables?</span><span class="si">{</span><span class="n">flags</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="s2">&quot;tables&quot;</span><span class="p">,</span>
                                                         <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                                  <span class="n">verbose</span><span class="p">,</span>
                                                                  <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="si">}</span><span class="s2"> </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing tables...&quot;</span><span class="p">)</span>
        <span class="n">tsp</span> <span class="o">=</span> <span class="n">TableSaxParser</span><span class="p">()</span>
        <span class="n">tsp</span><span class="o">.</span><span class="n">parseData</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">tsp</span><span class="o">.</span><span class="n">get_tables</span><span class="p">()</span>

<div class="viewcode-block" id="Tap.launch_job">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.Tap.html#astroquery.utils.tap.Tap.launch_job">[docs]</a>
    <span class="k">def</span> <span class="nf">launch_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">upload_resource</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">upload_table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launches a synchronous job</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query : str, mandatory</span>
<span class="sd">            query to be executed</span>
<span class="sd">        name : str, optional, default None</span>
<span class="sd">            custom name defined by the user for the job that is going to be created</span>
<span class="sd">        output_file : str, optional, default None</span>
<span class="sd">            file name where the results are saved if dumpToFile is True.</span>
<span class="sd">            If this parameter is not provided, the jobid is used instead</span>
<span class="sd">        output_format : str, optional, default &#39;votable&#39;</span>
<span class="sd">            results format</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        dump_to_file : bool, optional, default &#39;False&#39;</span>
<span class="sd">            if True, the results are saved in a file instead of using memory</span>
<span class="sd">        upload_resource : str, optional, default None</span>
<span class="sd">            resource to be uploaded to UPLOAD_SCHEMA</span>
<span class="sd">        upload_table_name : str, optional, default None</span>
<span class="sd">            resource temporary table name associated to the uploaded resource.</span>
<span class="sd">            This argument is required if upload_resource is provided.</span>
<span class="sd">        maxrec : int, optional, default None</span>
<span class="sd">            maximum number of rows to return (TAP ``MAXREC`` parameter)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Job object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">output_file_updated</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_suitable_output_file_name_for_current_output_format</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span>
                                                                                               <span class="n">output_format</span><span class="p">)</span>
        <span class="n">query</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">set_top_in_query</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="mi">2000</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Launched query: &#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">upload_resource</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">upload_table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table name is required when a resource is uploaded&quot;</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__launchJobMultipart</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                                 <span class="n">uploadResource</span><span class="o">=</span><span class="n">upload_resource</span><span class="p">,</span>
                                                 <span class="n">uploadTableName</span><span class="o">=</span><span class="n">upload_table_name</span><span class="p">,</span>
                                                 <span class="n">outputFormat</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                                                 <span class="n">context</span><span class="o">=</span><span class="s2">&quot;sync&quot;</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                                 <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                                 <span class="n">maxrec</span><span class="o">=</span><span class="n">maxrec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__launchJob</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                        <span class="n">outputFormat</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                                        <span class="n">context</span><span class="o">=</span><span class="s2">&quot;sync&quot;</span><span class="p">,</span>
                                        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                        <span class="n">maxrec</span><span class="o">=</span><span class="n">maxrec</span><span class="p">)</span>
        <span class="c1"># handle redirection</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">303</span><span class="p">:</span>
            <span class="c1"># redirection</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Redirection found&quot;</span><span class="p">)</span>
            <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">find_header</span><span class="p">(</span>
                <span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">(),</span>
                <span class="s2">&quot;location&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">location</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="s2">&quot;No location found &quot;</span>
                                                    <span class="s2">&quot;after redirection was &quot;</span>
                                                    <span class="s2">&quot;received (303)&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Redirect to </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">subcontext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__extract_sync_subcontext</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="n">subcontext</span><span class="p">,</span>
                                                         <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">Job</span><span class="p">(</span><span class="n">async_job</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">connhandler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="p">)</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                                  <span class="n">verbose</span><span class="p">,</span>
                                                                  <span class="mi">200</span><span class="p">,</span>
                                                                  <span class="n">raise_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">()</span>
        <span class="n">suitableOutputFile</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_suitable_output_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="p">,</span>
                                                               <span class="kc">False</span><span class="p">,</span>
                                                               <span class="n">output_file_updated</span><span class="p">,</span>
                                                               <span class="n">headers</span><span class="p">,</span>
                                                               <span class="n">isError</span><span class="p">,</span>
                                                               <span class="n">output_format</span><span class="p">)</span>
        <span class="n">job</span><span class="o">.</span><span class="n">outputFile</span> <span class="o">=</span> <span class="n">suitableOutputFile</span>
        <span class="n">job</span><span class="o">.</span><span class="n">outputFileUser</span> <span class="o">=</span> <span class="n">output_file</span>
        <span class="n">job</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_format</span>
        <span class="n">job</span><span class="o">.</span><span class="n">set_response_status</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
        <span class="n">job</span><span class="o">.</span><span class="n">set_phase</span><span class="p">(</span><span class="s1">&#39;PENDING&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isError</span><span class="p">:</span>
            <span class="n">job</span><span class="o">.</span><span class="n">failed</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">job</span><span class="o">.</span><span class="n">set_phase</span><span class="p">(</span><span class="s1">&#39;ERROR&#39;</span><span class="p">)</span>
            <span class="n">responseBytes</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">responseStr</span> <span class="o">=</span> <span class="n">responseBytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dump_to_file</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving error to: </span><span class="si">{</span><span class="n">suitableOutputFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">dump_to_file</span><span class="p">(</span><span class="n">suitableOutputFile</span><span class="p">,</span>
                                                <span class="n">responseStr</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span>
                <span class="n">taputils</span><span class="o">.</span><span class="n">parse_http_response_error</span><span class="p">(</span><span class="n">responseStr</span><span class="p">,</span>
                                                   <span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retrieving sync. results...&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dump_to_file</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving results to: </span><span class="si">{</span><span class="n">suitableOutputFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">dump_to_file</span><span class="p">(</span><span class="n">suitableOutputFile</span><span class="p">,</span> <span class="n">response</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">results</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">read_http_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">output_format</span><span class="p">)</span>
                <span class="n">job</span><span class="o">.</span><span class="n">set_results</span><span class="p">(</span><span class="n">results</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Query finished.&quot;</span><span class="p">)</span>
            <span class="n">job</span><span class="o">.</span><span class="n">_phase</span> <span class="o">=</span> <span class="s1">&#39;COMPLETED&#39;</span>
        <span class="k">return</span> <span class="n">job</span></div>


<div class="viewcode-block" id="Tap.launch_job_async">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.Tap.html#astroquery.utils.tap.Tap.launch_job_async">[docs]</a>
    <span class="k">def</span> <span class="nf">launch_job_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">upload_resource</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upload_table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">autorun</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launches an asynchronous job</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query : str, mandatory</span>
<span class="sd">            query to be executed</span>
<span class="sd">        name : str, optional, default None</span>
<span class="sd">            custom name defined by the user for the job that is going to be created</span>
<span class="sd">        output_file : str, optional, default None</span>
<span class="sd">            file name where the results are saved if dumpToFile is True.</span>
<span class="sd">            If this parameter is not provided, the jobid is used instead</span>
<span class="sd">        output_format : str, optional, default &#39;votable&#39;</span>
<span class="sd">            results format</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        dump_to_file : bool, optional, default &#39;False&#39;</span>
<span class="sd">            if True, the results are saved in a file instead of using memory</span>
<span class="sd">        background : bool, optional, default &#39;False&#39;</span>
<span class="sd">            when the job is executed in asynchronous mode, this flag specifies</span>
<span class="sd">            whether the execution will wait until results are available</span>
<span class="sd">        upload_resource : str, optional, default None</span>
<span class="sd">            resource to be uploaded to UPLOAD_SCHEMA</span>
<span class="sd">        upload_table_name : str, optional, default None</span>
<span class="sd">            resource temporary table name associated to the uploaded resource.</span>
<span class="sd">            This argument is required if upload_resource is provided.</span>
<span class="sd">        autorun : boolean, optional, default True</span>
<span class="sd">            if &#39;True&#39;, sets &#39;phase&#39; parameter to &#39;RUN&#39;,</span>
<span class="sd">            so the framework can start the job.</span>
<span class="sd">        maxrec : int, optional, default None</span>
<span class="sd">            maximum number of rows to return (TAP ``MAXREC`` parameter)</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Job object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="n">output_file_updated</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_suitable_output_file_name_for_current_output_format</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span>
                                                                                               <span class="n">output_format</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Launched query: &#39;</span><span class="si">{</span><span class="n">query</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">upload_resource</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">upload_table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                    <span class="s2">&quot;Table name is required when a resource is uploaded&quot;</span><span class="p">)</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__launchJobMultipart</span><span class="p">(</span><span class="n">query</span><span class="p">,</span>
                                                 <span class="n">upload_resource</span><span class="p">,</span>
                                                 <span class="n">upload_table_name</span><span class="p">,</span>
                                                 <span class="n">output_format</span><span class="p">,</span>
                                                 <span class="s2">&quot;async&quot;</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                                 <span class="n">autorun</span><span class="o">=</span><span class="n">autorun</span><span class="p">,</span>
                                                 <span class="n">maxrec</span><span class="o">=</span><span class="n">maxrec</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__launchJob</span><span class="p">(</span><span class="n">query</span><span class="p">,</span>
                                        <span class="n">output_format</span><span class="p">,</span>
                                        <span class="s2">&quot;async&quot;</span><span class="p">,</span>
                                        <span class="n">verbose</span><span class="p">,</span>
                                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                        <span class="n">autorun</span><span class="o">=</span><span class="n">autorun</span><span class="p">,</span>
                                        <span class="n">maxrec</span><span class="o">=</span><span class="n">maxrec</span><span class="p">)</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                                  <span class="n">verbose</span><span class="p">,</span>
                                                                  <span class="mi">303</span><span class="p">,</span>
                                                                  <span class="n">raise_exception</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">Job</span><span class="p">(</span><span class="n">async_job</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">connhandler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="p">)</span>
        <span class="n">headers</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">()</span>
        <span class="n">suitableOutputFile</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_suitable_output_file</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="p">,</span>
                                                               <span class="kc">True</span><span class="p">,</span>
                                                               <span class="n">output_file_updated</span><span class="p">,</span>
                                                               <span class="n">headers</span><span class="p">,</span>
                                                               <span class="n">isError</span><span class="p">,</span>
                                                               <span class="n">output_format</span><span class="p">)</span>
        <span class="n">job</span><span class="o">.</span><span class="n">outputFile</span> <span class="o">=</span> <span class="n">suitableOutputFile</span>
        <span class="n">job</span><span class="o">.</span><span class="n">outputFileUser</span> <span class="o">=</span> <span class="n">output_file</span>
        <span class="n">job</span><span class="o">.</span><span class="n">set_response_status</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
        <span class="n">job</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">output_format</span>
        <span class="n">job</span><span class="o">.</span><span class="n">set_phase</span><span class="p">(</span><span class="s1">&#39;PENDING&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isError</span><span class="p">:</span>
            <span class="n">job</span><span class="o">.</span><span class="n">failed</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">job</span><span class="o">.</span><span class="n">set_phase</span><span class="p">(</span><span class="s1">&#39;ERROR&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">dump_to_file</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Saving error to: </span><span class="si">{</span><span class="n">suitableOutputFile</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">dump_to_file</span><span class="p">(</span><span class="n">suitableOutputFile</span><span class="p">,</span>
                                                <span class="n">response</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">find_header</span><span class="p">(</span>
                <span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">(),</span>
                <span class="s2">&quot;location&quot;</span><span class="p">)</span>
            <span class="n">jobid</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_jobid_from_location</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;job </span><span class="si">{</span><span class="n">jobid</span><span class="si">}</span><span class="s2">, at: </span><span class="si">{</span><span class="n">location</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">job</span><span class="o">.</span><span class="n">jobid</span> <span class="o">=</span> <span class="n">jobid</span>
            <span class="n">job</span><span class="o">.</span><span class="n">remoteLocation</span> <span class="o">=</span> <span class="n">location</span>
            <span class="k">if</span> <span class="n">autorun</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
                <span class="n">job</span><span class="o">.</span><span class="n">set_phase</span><span class="p">(</span><span class="s1">&#39;EXECUTING&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="ow">not</span> <span class="n">background</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retrieving async. results...&quot;</span><span class="p">)</span>
                    <span class="c1"># saveResults or getResults will block (not background)</span>
                    <span class="k">if</span> <span class="n">dump_to_file</span><span class="p">:</span>
                        <span class="n">job</span><span class="o">.</span><span class="n">save_results</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
                    <span class="k">else</span><span class="p">:</span>
                        <span class="n">job</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
                        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Query finished.&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">job</span></div>


<div class="viewcode-block" id="Tap.load_async_job">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.Tap.html#astroquery.utils.tap.Tap.load_async_job">[docs]</a>
    <span class="k">def</span> <span class="nf">load_async_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">jobid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                       <span class="n">load_results</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads an asynchronous job</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        jobid : str, mandatory if no name is provided, default None</span>
<span class="sd">            job identifier</span>
<span class="sd">        name : str, mandatory if no jobid is provided, default None</span>
<span class="sd">            job name</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        load_results : bool, optional, default &#39;True&#39;</span>
<span class="sd">            load results associated to this job</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Job object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">jobfilter</span> <span class="o">=</span> <span class="n">Filter</span><span class="p">()</span>
            <span class="n">jobfilter</span><span class="o">.</span><span class="n">add_filter</span><span class="p">(</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="n">name</span><span class="p">)</span>
            <span class="n">jobs</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">search_async_jobs</span><span class="p">(</span><span class="n">jobfilter</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">jobs</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">jobs</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;No job found for name &#39;</span><span class="si">{</span><span class="n">name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
                <span class="k">return</span> <span class="kc">None</span>
            <span class="n">jobid</span> <span class="o">=</span> <span class="n">jobs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">jobid</span>
        <span class="k">if</span> <span class="n">jobid</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;No job identifier found&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="n">subContext</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;async/</span><span class="si">{</span><span class="n">jobid</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="n">subContext</span><span class="p">,</span>
                                                     <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                                  <span class="n">verbose</span><span class="p">,</span>
                                                                  <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># parse job</span>
        <span class="n">jsp</span> <span class="o">=</span> <span class="n">JobSaxParser</span><span class="p">(</span><span class="n">async_job</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">job</span> <span class="o">=</span> <span class="n">jsp</span><span class="o">.</span><span class="n">parseData</span><span class="p">(</span><span class="n">response</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">job</span><span class="o">.</span><span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span>
        <span class="c1"># load resulst</span>
        <span class="k">if</span> <span class="n">load_results</span><span class="p">:</span>
            <span class="n">job</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>
        <span class="k">return</span> <span class="n">job</span></div>


<div class="viewcode-block" id="Tap.list_async_jobs">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.Tap.html#astroquery.utils.tap.Tap.list_async_jobs">[docs]</a>
    <span class="k">def</span> <span class="nf">list_async_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns all the asynchronous jobs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of Job objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">subContext</span> <span class="o">=</span> <span class="s2">&quot;async&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="n">subContext</span><span class="p">,</span>
                                                     <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                                  <span class="n">verbose</span><span class="p">,</span>
                                                                  <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="c1"># parse jobs</span>
        <span class="n">jsp</span> <span class="o">=</span> <span class="n">JobListSaxParser</span><span class="p">(</span><span class="n">async_job</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">jobs</span> <span class="o">=</span> <span class="n">jsp</span><span class="o">.</span><span class="n">parseData</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">jobs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
                <span class="n">j</span><span class="o">.</span><span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span>
        <span class="k">return</span> <span class="n">jobs</span></div>


    <span class="k">def</span> <span class="nf">__appendData</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">args</span><span class="p">):</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">args</span><span class="p">)</span>
        <span class="n">result</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">firtsTime</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">data</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">firtsTime</span><span class="p">:</span>
                <span class="n">firtsTime</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">result</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">result</span><span class="si">}</span><span class="s2">&amp;</span><span class="si">{</span><span class="n">k</span><span class="si">}</span><span class="s2">=</span><span class="si">{</span><span class="n">data</span><span class="p">[</span><span class="n">k</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">return</span> <span class="n">result</span>

<div class="viewcode-block" id="Tap.save_results">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.Tap.html#astroquery.utils.tap.Tap.save_results">[docs]</a>
    <span class="k">def</span> <span class="nf">save_results</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">job</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Saves job results</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job : Job, mandatory</span>
<span class="sd">            job</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">job</span><span class="o">.</span><span class="n">save_results</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__launchJobMultipart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">uploadResource</span><span class="p">,</span> <span class="n">uploadTableName</span><span class="p">,</span>
                             <span class="n">outputFormat</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">autorun</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">uploadValue</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">uploadTableName</span><span class="si">}</span><span class="s2">,param:</span><span class="si">{</span><span class="n">uploadTableName</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;REQUEST&quot;</span><span class="p">:</span> <span class="s2">&quot;doQuery&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LANG&quot;</span><span class="p">:</span> <span class="s2">&quot;ADQL&quot;</span><span class="p">,</span>
            <span class="s2">&quot;FORMAT&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">outputFormat</span><span class="p">),</span>
            <span class="s2">&quot;tapclient&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tap_client_id</span><span class="p">),</span>
            <span class="s2">&quot;QUERY&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">),</span>
            <span class="s2">&quot;UPLOAD&quot;</span><span class="p">:</span> <span class="s2">&quot;&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">uploadValue</span><span class="p">)}</span>
        <span class="k">if</span> <span class="n">maxrec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;MAXREC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxrec</span>
        <span class="k">if</span> <span class="n">autorun</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;PHASE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;RUN&#39;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;jobname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">uploadResource</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
            <span class="n">fh</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">uploadResource</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;votable&#39;</span><span class="p">)</span>
            <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">chunk</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;pytable&#39;</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;votable&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">uploadResource</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">fh</span><span class="p">:</span>
                <span class="n">chunk</span> <span class="o">=</span> <span class="n">fh</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">uploadResource</span><span class="p">)</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[[</span><span class="n">uploadTableName</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">chunk</span><span class="p">]]</span>
        <span class="n">contentType</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">encode_multipart</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">execute_tappost</span><span class="p">(</span><span class="n">context</span><span class="p">,</span>
                                                      <span class="n">body</span><span class="p">,</span>
                                                      <span class="n">contentType</span><span class="p">,</span>
                                                      <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span> <span class="nf">__launchJob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="n">outputFormat</span><span class="p">,</span> <span class="n">context</span><span class="p">,</span> <span class="n">verbose</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">autorun</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">maxrec</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;REQUEST&quot;</span><span class="p">:</span> <span class="s2">&quot;doQuery&quot;</span><span class="p">,</span>
            <span class="s2">&quot;LANG&quot;</span><span class="p">:</span> <span class="s2">&quot;ADQL&quot;</span><span class="p">,</span>
            <span class="s2">&quot;FORMAT&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">outputFormat</span><span class="p">),</span>
            <span class="s2">&quot;tapclient&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">tap_client_id</span><span class="p">),</span>
            <span class="s2">&quot;QUERY&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">query</span><span class="p">)}</span>
        <span class="k">if</span> <span class="n">maxrec</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;MAXREC&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">maxrec</span>
        <span class="k">if</span> <span class="n">autorun</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;PHASE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;RUN&#39;</span>
        <span class="k">if</span> <span class="n">name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">args</span><span class="p">[</span><span class="s1">&#39;jobname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">name</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">execute_tappost</span><span class="p">(</span><span class="n">subcontext</span><span class="o">=</span><span class="n">context</span><span class="p">,</span>
                                                      <span class="n">data</span><span class="o">=</span><span class="n">urlencode</span><span class="p">(</span><span class="n">args</span><span class="p">),</span>
                                                      <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span>

    <span class="k">def</span> <span class="nf">__extract_sync_subcontext</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">location</span><span class="p">):</span>
        <span class="n">pos</span> <span class="o">=</span> <span class="n">location</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s1">&#39;sync&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">location</span>
        <span class="k">return</span> <span class="n">location</span><span class="p">[</span><span class="n">pos</span><span class="p">:]</span>

    <span class="k">def</span> <span class="nf">__findCookieInHeader</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">headers</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">cookies</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="o">.</span><span class="n">find_header</span><span class="p">(</span><span class="n">headers</span><span class="p">,</span> <span class="s1">&#39;Set-Cookie&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">cookies</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">cookies</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">items</span> <span class="o">=</span> <span class="n">cookies</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;;&#39;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">i</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;JSESSIONID=&quot;</span><span class="p">):</span>
                    <span class="k">return</span> <span class="n">i</span>
        <span class="k">return</span> <span class="kc">None</span>

    <span class="k">def</span> <span class="nf">__parseUrl</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">url</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">isHttps</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">url</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;https://&quot;</span><span class="p">):</span>
            <span class="n">isHttps</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">protocol</span> <span class="o">=</span> <span class="s2">&quot;https&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">protocol</span> <span class="o">=</span> <span class="s2">&quot;http&quot;</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;is https: </span><span class="si">{</span><span class="n">isHttps</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">urlInfoPos</span> <span class="o">=</span> <span class="n">url</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;://&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">urlInfoPos</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Invalid URL format&quot;</span><span class="p">)</span>

        <span class="n">urlInfo</span> <span class="o">=</span> <span class="n">url</span><span class="p">[(</span><span class="n">urlInfoPos</span> <span class="o">+</span> <span class="mi">3</span><span class="p">):]</span>

        <span class="n">items</span> <span class="o">=</span> <span class="n">urlInfo</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">urlInfo</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="n">itemsSize</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">items</span><span class="p">)</span>
        <span class="n">hostPort</span> <span class="o">=</span> <span class="n">items</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
        <span class="n">portPos</span> <span class="o">=</span> <span class="n">hostPort</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;:&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">portPos</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="c1"># port found</span>
            <span class="n">host</span> <span class="o">=</span> <span class="n">hostPort</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="n">portPos</span><span class="p">]</span>
            <span class="n">port</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">hostPort</span><span class="p">[</span><span class="n">portPos</span> <span class="o">+</span> <span class="mi">1</span><span class="p">:])</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># no port found</span>
            <span class="n">host</span> <span class="o">=</span> <span class="n">hostPort</span>
            <span class="c1"># no port specified: use defaults</span>
            <span class="k">if</span> <span class="n">isHttps</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="mi">443</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">port</span> <span class="o">=</span> <span class="mi">80</span>

        <span class="k">if</span> <span class="n">itemsSize</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">serverContext</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
            <span class="n">tapContext</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">itemsSize</span> <span class="o">==</span> <span class="mi">2</span><span class="p">:</span>
            <span class="n">serverContext</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">tapContext</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">elif</span> <span class="n">itemsSize</span> <span class="o">==</span> <span class="mi">3</span><span class="p">:</span>
            <span class="n">serverContext</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">items</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="n">tapContext</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">items</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">itemsSize</span> <span class="o">-</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">items</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">serverContext</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">util_create_string_from_buffer</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
            <span class="n">tapContext</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;/</span><span class="si">{</span><span class="n">items</span><span class="p">[</span><span class="n">itemsSize</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;protocol: &#39;</span><span class="si">{</span><span class="n">protocol</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;host: &#39;</span><span class="si">{</span><span class="n">host</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;port: &#39;</span><span class="si">{</span><span class="n">port</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;server context: &#39;</span><span class="si">{</span><span class="n">serverContext</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;tap context: &#39;</span><span class="si">{</span><span class="n">tapContext</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">protocol</span><span class="p">,</span> <span class="n">host</span><span class="p">,</span> <span class="n">port</span><span class="p">,</span> <span class="n">serverContext</span><span class="p">,</span> <span class="n">tapContext</span>

    <span class="k">def</span> <span class="fm">__str__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Created TAP+ (v</span><span class="si">{</span><span class="n">VERSION</span><span class="si">}</span><span class="s2">) - Connection:</span><span class="se">\n</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__connHandler</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span></div>



<div class="viewcode-block" id="TapPlus">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus">[docs]</a>
<span class="k">class</span> <span class="nc">TapPlus</span><span class="p">(</span><span class="n">Tap</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;TAP plus class</span>
<span class="sd">    Provides TAP and TAP+ capabilities</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">url</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">host</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">server_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">tap_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">port</span><span class="o">=</span><span class="mi">80</span><span class="p">,</span> <span class="n">sslport</span><span class="o">=</span><span class="mi">443</span><span class="p">,</span>
                 <span class="n">default_protocol_is_https</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">connhandler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">upload_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">table_edit_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">data_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">datalink_context</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                 <span class="n">client_id</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Constructor</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        url : str, mandatory if no host is specified, default None</span>
<span class="sd">            TAP URL</span>
<span class="sd">        host : str, optional, default None</span>
<span class="sd">            host name</span>
<span class="sd">        server_context : str, optional, default None</span>
<span class="sd">            server context</span>
<span class="sd">        tap_context : str, optional, default None</span>
<span class="sd">            tap context</span>
<span class="sd">        upload_context : str, optional, default None</span>
<span class="sd">            upload context</span>
<span class="sd">        table_edit_context : str, optional, default None</span>
<span class="sd">            context for all actions to be performed over a existing table</span>
<span class="sd">        data_context : str, optional, default None</span>
<span class="sd">            data context</span>
<span class="sd">        datalink_context : str, optional, default None</span>
<span class="sd">            datalink context</span>
<span class="sd">        port : int, optional, default &#39;80&#39;</span>
<span class="sd">            HTTP port</span>
<span class="sd">        sslport : int, optional, default &#39;443&#39;</span>
<span class="sd">            HTTPS port</span>
<span class="sd">        default_protocol_is_https : bool, optional, default False</span>
<span class="sd">            Specifies whether the default protocol to be used is HTTPS</span>
<span class="sd">        connhandler : connection handler object, optional, default None</span>
<span class="sd">            HTTP(s) connection hander (creator). If no handler is provided, a</span>
<span class="sd">            new one is created.</span>
<span class="sd">        verbose : bool, optional, default &#39;True&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="nb">super</span><span class="p">(</span><span class="n">TapPlus</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">url</span><span class="p">,</span> <span class="n">host</span><span class="o">=</span><span class="n">host</span><span class="p">,</span>
                                      <span class="n">server_context</span><span class="o">=</span><span class="n">server_context</span><span class="p">,</span>
                                      <span class="n">tap_context</span><span class="o">=</span><span class="n">tap_context</span><span class="p">,</span>
                                      <span class="n">upload_context</span><span class="o">=</span><span class="n">upload_context</span><span class="p">,</span>
                                      <span class="n">table_edit_context</span><span class="o">=</span><span class="n">table_edit_context</span><span class="p">,</span>
                                      <span class="n">data_context</span><span class="o">=</span><span class="n">data_context</span><span class="p">,</span>
                                      <span class="n">datalink_context</span><span class="o">=</span><span class="n">datalink_context</span><span class="p">,</span>
                                      <span class="n">port</span><span class="o">=</span><span class="n">port</span><span class="p">,</span> <span class="n">sslport</span><span class="o">=</span><span class="n">sslport</span><span class="p">,</span>
                                      <span class="n">default_protocol_is_https</span><span class="o">=</span><span class="n">default_protocol_is_https</span><span class="p">,</span>  <span class="c1"># noqa</span>
                                      <span class="n">connhandler</span><span class="o">=</span><span class="n">connhandler</span><span class="p">,</span>
                                      <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__internalInit</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__set_client_id</span><span class="p">(</span><span class="n">client_id</span><span class="o">=</span><span class="n">client_id</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__internalInit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__user</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pwd</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isLoggedIn</span> <span class="o">=</span> <span class="kc">False</span>

    <span class="k">def</span> <span class="nf">__set_client_id</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">client_id</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">client_id</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">tap_client_id</span> <span class="o">=</span> <span class="n">client_id</span>

<div class="viewcode-block" id="TapPlus.load_tables">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.load_tables">[docs]</a>
    <span class="k">def</span> <span class="nf">load_tables</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">only_names</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">include_shared_tables</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads all public tables</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        only_names : bool, TAP+ only, optional, default &#39;False&#39;</span>
<span class="sd">            True to load table names only</span>
<span class="sd">        include_shared_tables : bool, TAP+, optional, default &#39;False&#39;</span>
<span class="sd">            True to include shared tables</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of table objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tap__load_tables</span><span class="p">(</span><span class="n">only_names</span><span class="o">=</span><span class="n">only_names</span><span class="p">,</span>
                                      <span class="n">include_shared_tables</span><span class="o">=</span><span class="n">include_shared_tables</span><span class="p">,</span>  <span class="c1"># noqa</span>
                                      <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.load_data">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.load_data">[docs]</a>
    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">params_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the specified data</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params_dict : dictionary, mandatory</span>
<span class="sd">            list of request parameters</span>
<span class="sd">        output_file : string, optional, default None</span>
<span class="sd">            file where the results are saved.</span>
<span class="sd">            If it is not provided, the http response contents are returned.</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A table object if output_file is None.</span>
<span class="sd">        None if output_file is not None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retrieving data.&quot;</span><span class="p">)</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">params_dict</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Parameters dictionary expected&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">urlencode</span><span class="p">(</span><span class="n">params_dict</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Data request: </span><span class="si">{</span><span class="n">data</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_datapost</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Reading...&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span>
            <span class="n">file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="n">file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="s1">&#39;format&#39;</span> <span class="ow">in</span> <span class="n">params_dict</span><span class="p">:</span>
                <span class="n">output_format</span> <span class="o">=</span> <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;format&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;FORMAT&#39;</span> <span class="ow">in</span> <span class="n">params_dict</span><span class="p">:</span>
                    <span class="n">output_format</span> <span class="o">=</span> <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;FORMAT&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">output_format</span> <span class="o">=</span> <span class="s2">&quot;votable&quot;</span>
            <span class="n">results</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">read_http_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">output_format</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">results</span></div>


<div class="viewcode-block" id="TapPlus.load_groups">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.load_groups">[docs]</a>
    <span class="k">def</span> <span class="nf">load_groups</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads groups</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A set of groups of a user</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="s2">&quot;share?action=GetGroups&quot;</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parsing groups...&quot;</span><span class="p">)</span>
        <span class="n">gsp</span> <span class="o">=</span> <span class="n">GroupSaxParser</span><span class="p">()</span>
        <span class="n">gsp</span><span class="o">.</span><span class="n">parseData</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Done. </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">gsp</span><span class="o">.</span><span class="n">get_groups</span><span class="p">())</span><span class="si">}</span><span class="s2"> groups found&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">gsp</span><span class="o">.</span><span class="n">get_groups</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">gsp</span><span class="o">.</span><span class="n">get_groups</span><span class="p">()</span></div>


<div class="viewcode-block" id="TapPlus.load_group">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.load_group">[docs]</a>
    <span class="k">def</span> <span class="nf">load_group</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Load group with title being group_name</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_name : str, required</span>
<span class="sd">            group to be loaded</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A group with title being group_name</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;group_name&#39; must be specified&quot;</span><span class="p">)</span>
        <span class="n">groups</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_groups</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">title</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">group_name</span><span class="p">):</span>
                <span class="n">group</span> <span class="o">=</span> <span class="n">g</span>
                <span class="k">break</span>
        <span class="k">return</span> <span class="n">group</span></div>


<div class="viewcode-block" id="TapPlus.load_shared_items">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.load_shared_items">[docs]</a>
    <span class="k">def</span> <span class="nf">load_shared_items</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads shared items</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A set of shared items</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">context</span> <span class="o">=</span> <span class="s2">&quot;share?action=GetSharedItems&quot;</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Parsing shared items...&quot;</span><span class="p">)</span>
        <span class="n">ssp</span> <span class="o">=</span> <span class="n">SharedItemsSaxParser</span><span class="p">()</span>
        <span class="n">ssp</span><span class="o">.</span><span class="n">parseData</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Done. </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">ssp</span><span class="o">.</span><span class="n">get_shared_items</span><span class="p">())</span><span class="si">}</span><span class="s2"> shared items found&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">ssp</span><span class="o">.</span><span class="n">get_shared_items</span><span class="p">():</span>
                <span class="nb">print</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">title</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">ssp</span><span class="o">.</span><span class="n">get_shared_items</span><span class="p">()</span></div>


<div class="viewcode-block" id="TapPlus.share_table">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.share_table">[docs]</a>
    <span class="k">def</span> <span class="nf">share_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Shares a table with a group</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_name : str, required</span>
<span class="sd">            group in which table will be shared</span>
<span class="sd">        table_name : str, required</span>
<span class="sd">            table to be shared</span>
<span class="sd">        description : str, required</span>
<span class="sd">            description of the sharing</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both &#39;group_name&#39; and &#39;table_name&#39; must be specified&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action=CreateOrUpdateItem&amp;resource_type=0&amp;title=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&amp;description=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&amp;items_list=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">|Group|Read&quot;</span><span class="p">)</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_share</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Shared table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39; to group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.share_table_stop">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.share_table_stop">[docs]</a>
    <span class="k">def</span> <span class="nf">share_table_stop</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Stop sharing a table</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_name : str, required</span>
<span class="sd">            group where the table is shared to</span>
<span class="sd">        table_name : str, required</span>
<span class="sd">            table to be stopped from being shared</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both &#39;group_name&#39; and &#39;table_name&#39; must be specified&quot;</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
        <span class="n">shared_items</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_shared_items</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">shared_item</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">s</span> <span class="ow">in</span> <span class="n">shared_items</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">s</span><span class="o">.</span><span class="n">title</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">):</span>
                <span class="c1"># check group</span>
                <span class="n">groups</span> <span class="o">=</span> <span class="n">s</span><span class="o">.</span><span class="n">shared_to_items</span>
                <span class="k">for</span> <span class="n">g</span> <span class="ow">in</span> <span class="n">groups</span><span class="p">:</span>
                    <span class="k">if</span> <span class="n">group</span><span class="o">.</span><span class="n">id</span> <span class="o">==</span> <span class="n">g</span><span class="o">.</span><span class="n">id</span><span class="p">:</span>
                        <span class="n">shared_item</span> <span class="o">=</span> <span class="n">s</span>
                        <span class="k">break</span>
                <span class="k">if</span> <span class="n">shared_item</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">break</span>
        <span class="k">if</span> <span class="n">shared_item</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39;, shared to group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;, not found.&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action=RemoveItem&amp;resource_type=0&amp;resource_id=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">shared_item</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&amp;resource_type=0&quot;</span><span class="p">)</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_share</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>

        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Stop sharing table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39; to group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.share_group_create">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.share_group_create">[docs]</a>
    <span class="k">def</span> <span class="nf">share_group_create</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">group_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a group</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_name : str, required</span>
<span class="sd">            group to be created</span>
<span class="sd">        description : str, required</span>
<span class="sd">            description of the group</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;group_name&#39; must be specified&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group </span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2"> already exists&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action=CreateOrUpdateGroup&amp;resource_type=0&amp;title=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;&amp;description=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">description</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_share</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Created group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.share_group_delete">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.share_group_delete">[docs]</a>
    <span class="k">def</span> <span class="nf">share_group_delete</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                           <span class="n">group_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes a group</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_name : str, required</span>
<span class="sd">            group to be created</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;group_name&#39; must be specified&quot;</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39; doesn&#39;t exist&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action=RemoveGroup&amp;resource_type=0&amp;group_id=</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_share</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Deleted group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.share_group_add_user">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.share_group_add_user">[docs]</a>
    <span class="k">def</span> <span class="nf">share_group_add_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                             <span class="n">group_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                             <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Adds user to a group</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_name : str, required</span>
<span class="sd">            group which user_id will be added in</span>
<span class="sd">        user_id : str, required</span>
<span class="sd">            user id to be added</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">user_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both &#39;group_name&#39; and &#39;user_id&#39; must be specified&quot;</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39; doesn&#39;t exist&quot;</span><span class="p">)</span>
        <span class="n">user_found_in_group</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">:</span>
                <span class="n">user_found_in_group</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">user_found_in_group</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User id &#39;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&#39; found in group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid_user</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User id &#39;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&#39; not found.&quot;</span><span class="p">)</span>
        <span class="n">users</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="n">users</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">users</span><span class="si">}{</span><span class="n">u</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">,&quot;</span>
        <span class="n">users</span> <span class="o">=</span> <span class="n">users</span> <span class="o">+</span> <span class="n">user_id</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;action=CreateOrUpdateGroup&amp;group_id=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&amp;title=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&amp;description=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&amp;users_list=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">users</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_share</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Added user &#39;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&#39; from group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.share_group_delete_user">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.share_group_delete_user">[docs]</a>
    <span class="k">def</span> <span class="nf">share_group_delete_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span>
                                <span class="n">group_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Deletes user from a group</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        group_name : str, required</span>
<span class="sd">            group which user_id will be removed from</span>
<span class="sd">        user_id : str, required</span>
<span class="sd">            user id to be deleted</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">group_name</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">user_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both &#39;group_name&#39; and &#39;user_id&#39; must be specified&quot;</span><span class="p">)</span>
        <span class="n">group</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_group</span><span class="p">(</span><span class="n">group_name</span><span class="o">=</span><span class="n">group_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">group</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39; doesn&#39;t exist&quot;</span><span class="p">)</span>
        <span class="n">user_found_in_group</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">==</span> <span class="n">user_id</span><span class="p">:</span>
                <span class="n">user_found_in_group</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">break</span>
        <span class="k">if</span> <span class="n">user_found_in_group</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;User id &#39;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&#39; not found in group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="n">users</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">for</span> <span class="n">u</span> <span class="ow">in</span> <span class="n">group</span><span class="o">.</span><span class="n">users</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">id</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">user_id</span><span class="p">):</span>
                <span class="k">continue</span>
            <span class="n">users</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">users</span><span class="si">}{</span><span class="n">u</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">,&quot;</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">users</span><span class="p">)</span> <span class="o">!=</span> <span class="s2">&quot;&quot;</span><span class="p">:</span>
            <span class="n">users</span> <span class="o">=</span> <span class="n">users</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">(</span><span class="sa">f</span><span class="s2">&quot;action=CreateOrUpdateGroup&amp;group_id=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">id</span><span class="si">}</span><span class="s2">&amp;title=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">title</span><span class="si">}</span><span class="s2">&amp;description=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">group</span><span class="o">.</span><span class="n">description</span><span class="si">}</span><span class="s2">&amp;users_list=&quot;</span>
                <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">users</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_share</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Deleted user &#39;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&#39; from group &#39;</span><span class="si">{</span><span class="n">group_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.is_valid_user">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.is_valid_user">[docs]</a>
    <span class="k">def</span> <span class="nf">is_valid_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">user_id</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Determines if the specified user exists in the system</span>
<span class="sd">        TAP+ only</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_id : str, mandatory</span>
<span class="sd">            user id to be checked</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Boolean indicating if the specified user exists</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">user_id</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;&#39;user_id&#39; must be specified&quot;</span><span class="p">)</span>
        <span class="n">context</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;users?USER=</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="n">context</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">responseBytes</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">user</span> <span class="o">=</span> <span class="n">responseBytes</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;USER response = </span><span class="si">{</span><span class="n">user</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">user</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">user_id</span><span class="si">}</span><span class="s2">:&quot;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">user</span><span class="o">.</span><span class="n">count</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\\</span><span class="s2">n&quot;</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span></div>


<div class="viewcode-block" id="TapPlus.get_datalinks">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.get_datalinks">[docs]</a>
    <span class="k">def</span> <span class="nf">get_datalinks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets datalinks associated to the provided identifiers</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ids : str list, mandatory</span>
<span class="sd">            list of identifiers</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A table object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Retrieving datalink.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ids</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing mandatory argument &#39;ids&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ids_arg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ID=</span><span class="si">{</span><span class="n">ids</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">ids_arg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ID=</span><span class="si">{</span><span class="n">ids</span><span class="si">}</span><span class="s2">&quot;</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ids_arg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;ID=</span><span class="si">{</span><span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="n">item</span><span class="w"> </span><span class="ow">in</span><span class="w"> </span><span class="n">ids</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Datalink request: </span><span class="si">{</span><span class="n">ids_arg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_datalinkpost</span><span class="p">(</span><span class="n">subcontext</span><span class="o">=</span><span class="s2">&quot;links&quot;</span><span class="p">,</span>
                                                    <span class="n">data</span><span class="o">=</span><span class="n">ids_arg</span><span class="p">,</span>
                                                    <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Done.&quot;</span><span class="p">)</span>
        <span class="n">results</span> <span class="o">=</span> <span class="n">utils</span><span class="o">.</span><span class="n">read_http_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="s2">&quot;votable&quot;</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">results</span></div>


<div class="viewcode-block" id="TapPlus.search_async_jobs">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.search_async_jobs">[docs]</a>
    <span class="k">def</span> <span class="nf">search_async_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">jobfilter</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Searches for jobs applying the specified filter</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        jobfilter : JobFilter, optional, default None</span>
<span class="sd">            job filter</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A list of Job objects</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># jobs/list?[&amp;session=][&amp;limit=][&amp;offset=][&amp;order=][&amp;metadata_only=true|false]</span>
        <span class="n">subContext</span> <span class="o">=</span> <span class="s2">&quot;jobs/async&quot;</span>
        <span class="k">if</span> <span class="n">jobfilter</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">data</span> <span class="o">=</span> <span class="n">jobfilter</span><span class="o">.</span><span class="n">createUrlRequest</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">data</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">subContext</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">subContext</span><span class="si">}</span><span class="s2">?</span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">__appendData</span><span class="p">(</span><span class="n">data</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="n">subContext</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="c1"># parse jobs</span>
        <span class="n">jsp</span> <span class="o">=</span> <span class="n">JobSaxParser</span><span class="p">(</span><span class="n">async_job</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">jobs</span> <span class="o">=</span> <span class="n">jsp</span><span class="o">.</span><span class="n">parseData</span><span class="p">(</span><span class="n">response</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">jobs</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">jobs</span><span class="p">:</span>
                <span class="n">j</span><span class="o">.</span><span class="n">connHandler</span> <span class="o">=</span> <span class="n">connHandler</span>
        <span class="k">return</span> <span class="n">jobs</span></div>


<div class="viewcode-block" id="TapPlus.remove_jobs">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.remove_jobs">[docs]</a>
    <span class="k">def</span> <span class="nf">remove_jobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">jobs_list</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes the specified jobs</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        jobs_list : str, mandatory</span>
<span class="sd">            jobs identifiers to be removed</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">jobs_list</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">return</span>
        <span class="n">jobsIds</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">jobs_list</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">jobsIds</span> <span class="o">=</span> <span class="n">jobs_list</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">jobs_list</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">jobsIds</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">jobs_list</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;Invalid object type&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Jobs to be removed: </span><span class="si">{</span><span class="n">jobsIds</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;JOB_IDS=</span><span class="si">{</span><span class="n">jobsIds</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="n">subContext</span> <span class="o">=</span> <span class="s2">&quot;deletejobs&quot;</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_tappost</span><span class="p">(</span><span class="n">subContext</span><span class="p">,</span>
                                               <span class="n">data</span><span class="p">,</span>
                                               <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Removed jobs: &#39;</span><span class="si">{</span><span class="n">jobs_list</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__execLogin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">usr</span><span class="p">,</span> <span class="n">pwd</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">subContext</span> <span class="o">=</span> <span class="s2">&quot;login&quot;</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;username&quot;</span><span class="p">:</span> <span class="n">usr</span><span class="p">,</span>
            <span class="s2">&quot;password&quot;</span><span class="p">:</span> <span class="n">pwd</span><span class="p">}</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_secure</span><span class="p">(</span><span class="n">subcontext</span><span class="o">=</span><span class="n">subContext</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">urlencode</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="k">return</span> <span class="n">response</span>

<div class="viewcode-block" id="TapPlus.upload_table">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.upload_table">[docs]</a>
    <span class="k">def</span> <span class="nf">upload_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">upload_resource</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">table_description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="nb">format</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Uploads a table to the user private space</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        upload_resource : object, mandatory</span>
<span class="sd">            table to be uploaded: pyTable, file or URL.</span>
<span class="sd">        table_name : str, required if uploadResource is provided, default None</span>
<span class="sd">            resource temporary table name associated to the uploaded resource</span>
<span class="sd">        table_description : str, optional, default None</span>
<span class="sd">            table description</span>
<span class="sd">        format : str, optional, default &#39;VOTable&#39;</span>
<span class="sd">            resource format</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">upload_resource</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing mandatory argument &#39;upload_resource&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing mandatory argument &#39;table_name&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">table_description</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="nb">format</span> <span class="o">=</span> <span class="s2">&quot;votable&quot;</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__uploadTableMultipart</span><span class="p">(</span><span class="n">resource</span><span class="o">=</span><span class="n">upload_resource</span><span class="p">,</span>
                                               <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
                                               <span class="n">table_description</span><span class="o">=</span><span class="n">description</span><span class="p">,</span>
                                               <span class="n">resource_format</span><span class="o">=</span><span class="nb">format</span><span class="p">,</span>
                                               <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">303</span><span class="p">:</span>
            <span class="n">location</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span><span class="o">.</span><span class="n">find_header</span><span class="p">(</span>
                <span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">(),</span>
                <span class="s2">&quot;location&quot;</span><span class="p">)</span>
            <span class="n">jobid</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_jobid_from_location</span><span class="p">(</span><span class="n">location</span><span class="p">)</span>
            <span class="n">job</span> <span class="o">=</span> <span class="n">Job</span><span class="p">(</span><span class="n">async_job</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                      <span class="n">query</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">connhandler</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">())</span>
            <span class="n">job</span><span class="o">.</span><span class="n">jobid</span> <span class="o">=</span> <span class="n">jobid</span>
            <span class="n">job</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;Table upload&#39;</span>
            <span class="n">job</span><span class="o">.</span><span class="n">set_phase</span><span class="p">(</span><span class="s1">&#39;EXECUTING&#39;</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job &#39;</span><span class="si">{</span><span class="n">jobid</span><span class="si">}</span><span class="s2">&#39; created to upload table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">job</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Uploaded table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39;.&quot;</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span></div>


    <span class="k">def</span> <span class="nf">__uploadTableMultipart</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">table_description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                               <span class="n">resource_format</span><span class="o">=</span><span class="s2">&quot;VOTable&quot;</span><span class="p">,</span>
                               <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="n">Table</span><span class="p">):</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;TASKID&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                <span class="s2">&quot;TABLE_NAME&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
                <span class="s2">&quot;TABLE_DESC&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_description</span><span class="p">),</span>
                <span class="s2">&quot;FORMAT&quot;</span><span class="p">:</span> <span class="s1">&#39;votable&#39;</span><span class="p">}</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Sending pytable.&quot;</span><span class="p">)</span>
            <span class="n">fh</span> <span class="o">=</span> <span class="n">tempfile</span><span class="o">.</span><span class="n">NamedTemporaryFile</span><span class="p">(</span><span class="n">delete</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="n">resource</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">fh</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;votable&#39;</span><span class="p">)</span>
            <span class="n">fh</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">f</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span>
            <span class="n">chunk</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
            <span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
            <span class="n">os</span><span class="o">.</span><span class="n">unlink</span><span class="p">(</span><span class="n">fh</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s1">&#39;pytable&#39;</span><span class="p">,</span> <span class="n">chunk</span><span class="p">]]</span>
            <span class="n">contentType</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">encode_multipart</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">resource</span><span class="p">)</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s2">&quot;http&quot;</span><span class="p">)):</span>  <span class="c1"># upload from file</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;TASKID&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="s2">&quot;TABLE_NAME&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
                    <span class="s2">&quot;TABLE_DESC&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_description</span><span class="p">),</span>
                    <span class="s2">&quot;FORMAT&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">resource_format</span><span class="p">)}</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Sending file: </span><span class="si">{</span><span class="n">resource</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
                <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">resource</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
                    <span class="n">chunk</span> <span class="o">=</span> <span class="n">f</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
                <span class="n">files</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">resource</span><span class="p">),</span> <span class="n">chunk</span><span class="p">]]</span>
                <span class="n">contentType</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">encode_multipart</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>  <span class="c1"># upload from URL</span>
                <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                    <span class="s2">&quot;TASKID&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
                    <span class="s2">&quot;TABLE_NAME&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
                    <span class="s2">&quot;TABLE_DESC&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_description</span><span class="p">),</span>
                    <span class="s2">&quot;FORMAT&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">resource_format</span><span class="p">),</span>
                    <span class="s2">&quot;URL&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">resource</span><span class="p">)}</span>
                <span class="n">files</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]]</span>
                <span class="n">contentType</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">encode_multipart</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_upload</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">contentType</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">303</span> <span class="ow">and</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">!=</span> <span class="mi">302</span><span class="p">:</span>
            <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                     <span class="n">verbose</span><span class="p">,</span>
                                                     <span class="mi">200</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>

<div class="viewcode-block" id="TapPlus.upload_table_from_job">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.upload_table_from_job">[docs]</a>
    <span class="k">def</span> <span class="nf">upload_table_from_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">job</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                              <span class="n">table_description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Creates a table to the user private space from a job</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        job: job, mandatory</span>
<span class="sd">            job used to create a table. Could be a string with the jobid or</span>
<span class="sd">            a job itself</span>
<span class="sd">        table_name : str, default &#39;t&#39;+jobid</span>
<span class="sd">            resource temporary table name associated to the uploaded resource</span>
<span class="sd">        table_description : str, optional, default None</span>
<span class="sd">            table description</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">job</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Missing mandatory argument &#39;job&#39;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">job</span><span class="p">,</span> <span class="n">Job</span><span class="p">):</span>
            <span class="n">j</span> <span class="o">=</span> <span class="n">job</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">j</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_async_job</span><span class="p">(</span><span class="n">jobid</span><span class="o">=</span><span class="n">job</span><span class="p">,</span> <span class="n">load_results</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">j</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Job </span><span class="si">{</span><span class="n">job</span><span class="si">}</span><span class="s2"> not found&quot;</span><span class="p">)</span>
                <span class="k">return</span>
            <span class="n">description</span> <span class="o">=</span> <span class="n">j</span><span class="o">.</span><span class="n">parameters</span><span class="p">[</span><span class="s1">&#39;query&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">table_name</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;t</span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">jobid</span><span class="si">}</span><span class="s2">&quot;</span>
        <span class="k">if</span> <span class="n">table_description</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">table_description</span> <span class="o">=</span> <span class="n">description</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;JOB = </span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">jobid</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__uploadTableMultipartFromJob</span><span class="p">(</span><span class="n">resource</span><span class="o">=</span><span class="n">j</span><span class="o">.</span><span class="n">jobid</span><span class="p">,</span>
                                           <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
                                           <span class="n">table_description</span><span class="o">=</span><span class="n">table_description</span><span class="p">,</span>
                                           <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Created table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39; from job: &#39;</span><span class="si">{</span><span class="n">j</span><span class="o">.</span><span class="n">jobid</span><span class="si">}</span><span class="s2">&#39;.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__uploadTableMultipartFromJob</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">resource</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                      <span class="n">table_description</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;TASKID&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;JOBID&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">resource</span><span class="p">),</span>
            <span class="s2">&quot;TABLE_NAME&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
            <span class="s2">&quot;TABLE_DESC&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_description</span><span class="p">),</span>
            <span class="s2">&quot;FORMAT&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="nb">format</span><span class="p">)}</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">[[</span><span class="s1">&#39;FILE&#39;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">]]</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">contentType</span><span class="p">,</span> <span class="n">body</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">encode_multipart</span><span class="p">(</span><span class="n">args</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_upload</span><span class="p">(</span><span class="n">body</span><span class="p">,</span> <span class="n">contentType</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">response</span>

<div class="viewcode-block" id="TapPlus.delete_user_table">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.delete_user_table">[docs]</a>
    <span class="k">def</span> <span class="nf">delete_user_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">force_removal</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Removes a user table</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table_name : str, required</span>
<span class="sd">            table to be removed</span>
<span class="sd">        force_removal : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to indicate if removal should be forced</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table name cannot be null&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">force_removal</span> <span class="ow">is</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;TABLE_NAME&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
                <span class="s2">&quot;DELETE&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;FORCE_REMOVAL&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;TABLE_NAME&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
                <span class="s2">&quot;DELETE&quot;</span><span class="p">:</span> <span class="s2">&quot;TRUE&quot;</span><span class="p">,</span>
                <span class="s2">&quot;FORCE_REMOVAL&quot;</span><span class="p">:</span> <span class="s2">&quot;FALSE&quot;</span><span class="p">}</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_upload</span><span class="p">(</span><span class="n">urlencode</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39; deleted.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.rename_table">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.rename_table">[docs]</a>
    <span class="k">def</span> <span class="nf">rename_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">new_column_names_dict</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot; This method allows you to update the column names of a user table.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table_name: str, required</span>
<span class="sd">            old name of the user&#39;s table</span>
<span class="sd">        new_table_name: str, required</span>
<span class="sd">            new name of the user&#39;s table</span>
<span class="sd">        new_column_names_dict: dict str:str</span>
<span class="sd">            dict with pairs &quot;old_column1_name:new_column1_name&quot;</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">new_column_names_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">new_column_names_dict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Argument &#39;table_name&#39; is mandatory. &quot;</span>
                <span class="s2">&quot;Please introduce the name of the table that is going to be updated&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">new_table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">and</span> <span class="p">(</span><span class="n">new_column_names_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please introduce as minimum a new name for the table or a new name for a column with &quot;</span>
                             <span class="s2">&quot;format old_column1_name:new_column1_name, ... ,old_columnN_name:new_columnN_name&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">new_table_name</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">new_column_names_dict</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="c1"># case 1: We only need to rename the table</span>
                <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_args_4_rename_table</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">new_table_name</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># case 2: We need to rename both, table and column names</span>
                <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_args_4_rename_table</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">new_table_name</span><span class="p">,</span> <span class="n">new_column_names_dict</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">new_column_names_dict</span><span class="p">:</span>
                <span class="c1"># case 3: We only need to rename the columns but same table name</span>
                <span class="n">args</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">get_args_4_rename_table</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">new_column_names_dict</span><span class="p">)</span>

        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_table_tool</span><span class="p">(</span><span class="n">urlencode</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39; updated.&quot;</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.get_args_4_rename_table">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.get_args_4_rename_table">[docs]</a>
    <span class="k">def</span> <span class="nf">get_args_4_rename_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">table_name</span><span class="p">,</span> <span class="n">new_table_name</span><span class="p">,</span> <span class="n">new_column_names_dict</span><span class="p">):</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">new_column_names_dict</span><span class="p">:</span>
            <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;rename&quot;</span><span class="p">,</span>
                <span class="s2">&quot;new_table_name&quot;</span><span class="p">:</span> <span class="n">new_table_name</span><span class="p">,</span>
                <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">table_name</span>
            <span class="p">}</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_column_names</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">key</span><span class="si">}</span><span class="s1">:</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">new_column_names_dict</span><span class="o">.</span><span class="n">items</span><span class="p">())</span>

            <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s2">&quot;action&quot;</span><span class="p">:</span> <span class="s2">&quot;rename&quot;</span><span class="p">,</span>
                <span class="s2">&quot;new_column_names&quot;</span><span class="p">:</span> <span class="n">new_column_names</span><span class="p">,</span>
                <span class="s2">&quot;new_table_name&quot;</span><span class="p">:</span> <span class="n">new_table_name</span><span class="p">,</span>
                <span class="s2">&quot;table_name&quot;</span><span class="p">:</span> <span class="n">table_name</span>
            <span class="p">}</span>
        <span class="k">return</span> <span class="n">args</span></div>


<div class="viewcode-block" id="TapPlus.update_user_table">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.update_user_table">[docs]</a>
    <span class="k">def</span> <span class="nf">update_user_table</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">list_of_changes</span><span class="o">=</span><span class="p">[],</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Updates a user table</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table_name : str</span>
<span class="sd">            table to be updated</span>
<span class="sd">        list_of_changes : list</span>
<span class="sd">            list of lists, each one of them containing sets of</span>
<span class="sd">            [column_name, field_name, value].</span>
<span class="sd">            column_name is the name of the column to be updated</span>
<span class="sd">            field_name is the name of the tap field to be modified</span>
<span class="sd">            field name can be &#39;utype&#39;, &#39;ucd&#39;, &#39;flags&#39; or &#39;indexed&#39;</span>
<span class="sd">            value is the new value this field of this column will take</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table name cannot be null&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">list_of_changes</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;List of changes cannot be empty&quot;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">list_of_changes</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">change</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;None of the changes can be null&quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">change</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">3</span><span class="p">:</span>  <span class="c1"># [column_name, field_name, value]</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;All of the changes must have three elements: [column_name, field_name, value]&quot;</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">change</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;None of the values for the changes can be null&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">index</span> <span class="o">==</span> <span class="mi">1</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="s1">&#39;utype&#39;</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="s1">&#39;ucd&#39;</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="s1">&#39;flags&#39;</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span> <span class="s1">&#39;indexed&#39;</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Position 2 of all changes must be &#39;utype&#39;, &#39;ucd&#39;, &#39;flags&#39; or &#39;indexed&#39;&quot;</span><span class="p">)</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">table</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">load_table</span><span class="p">(</span><span class="n">table</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">table</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table name not found&quot;</span><span class="p">)</span>
        <span class="n">columns</span> <span class="o">=</span> <span class="n">table</span><span class="o">.</span><span class="n">columns</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table has no columns&quot;</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">list_of_changes</span><span class="p">:</span>
            <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">change</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">found</span> <span class="o">=</span> <span class="kc">False</span>
                    <span class="k">for</span> <span class="n">c</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                        <span class="k">if</span> <span class="n">c</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="n">value</span><span class="p">:</span>
                            <span class="n">found</span> <span class="o">=</span> <span class="kc">True</span>
                            <span class="k">break</span>
                    <span class="k">if</span> <span class="n">found</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Column name introduced &quot;</span>
                                         <span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;</span>
                                         <span class="sa">f</span><span class="s2">&quot; was not found in the table&quot;</span><span class="p">)</span>
                <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>

        <span class="n">new_ra_column</span> <span class="o">=</span> <span class="n">TapPlus</span><span class="o">.</span><span class="n">__changesContainFlag</span><span class="p">(</span><span class="n">changes</span><span class="o">=</span><span class="n">list_of_changes</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&quot;Ra&quot;</span><span class="p">)</span>
        <span class="n">new_dec_column</span> <span class="o">=</span> <span class="n">TapPlus</span><span class="o">.</span><span class="n">__changesContainFlag</span><span class="p">(</span><span class="n">changes</span><span class="o">=</span><span class="n">list_of_changes</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="s2">&quot;Dec&quot;</span><span class="p">)</span>

        <span class="c1"># check whether both (Ra/Dec) are present</span>
        <span class="c1"># or both are None</span>
        <span class="k">if</span> <span class="p">((</span><span class="n">new_ra_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_dec_column</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">)</span>
                <span class="ow">or</span> <span class="p">(</span><span class="n">new_ra_column</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">and</span> <span class="n">new_dec_column</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Both Ra and Dec must be specified when updating one of them.&quot;</span><span class="p">)</span>

        <span class="n">args</span> <span class="o">=</span> <span class="n">TapPlus</span><span class="o">.</span><span class="n">get_table_update_arguments</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span>
                                                  <span class="n">list_of_changes</span><span class="p">)</span>

        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_table_edit</span><span class="p">(</span><span class="n">urlencode</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                 <span class="n">verbose</span><span class="p">,</span>
                                                 <span class="mi">200</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39; updated.&quot;</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">msg</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.get_table_update_arguments">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.get_table_update_arguments">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_table_update_arguments</span><span class="p">(</span><span class="n">table_name</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">list_of_changes</span><span class="p">):</span>
        <span class="n">num_cols</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span>
        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ACTION&quot;</span><span class="p">:</span> <span class="s2">&quot;edit&quot;</span><span class="p">,</span>
            <span class="s2">&quot;NUMTABLES&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
            <span class="s2">&quot;TABLE0_NUMCOLS&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">num_cols</span><span class="p">),</span>
            <span class="s2">&quot;TABLE0&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="n">index</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">found_in_changes</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">list_of_changes</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">name</span><span class="p">)):</span>
                    <span class="n">found_in_changes</span> <span class="o">=</span> <span class="kc">True</span>
                    <span class="k">break</span>

            <span class="c1"># set current values</span>
            <span class="n">column_name</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">indexed</span><span class="p">,</span> <span class="n">ucd</span><span class="p">,</span> <span class="n">utype</span> <span class="o">=</span> \
                <span class="n">TapPlus</span><span class="o">.</span><span class="n">get_current_column_values_for_update</span><span class="p">(</span><span class="n">column</span><span class="p">)</span>

            <span class="c1"># Update values if required</span>
            <span class="k">if</span> <span class="n">found_in_changes</span><span class="p">:</span>
                <span class="n">flags</span><span class="p">,</span> <span class="n">indexed</span><span class="p">,</span> <span class="n">ucd</span><span class="p">,</span> <span class="n">utype</span> <span class="o">=</span> \
                    <span class="n">TapPlus</span><span class="o">.</span><span class="n">get_new_column_values_for_update</span><span class="p">(</span><span class="n">list_of_changes</span><span class="p">,</span>
                                                             <span class="n">column_name</span><span class="p">,</span>
                                                             <span class="n">flags</span><span class="p">,</span>
                                                             <span class="n">indexed</span><span class="p">,</span>
                                                             <span class="n">ucd</span><span class="p">,</span> <span class="n">utype</span><span class="p">)</span>

            <span class="c1"># Prepare http request parameters for a column</span>
            <span class="n">args</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;TABLE0_COL</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">column_name</span><span class="p">)</span>
            <span class="n">args</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;TABLE0_COL</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">_UCD&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ucd</span><span class="p">)</span>
            <span class="n">args</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;TABLE0_COL</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">_UTYPE&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">utype</span><span class="p">)</span>
            <span class="n">args</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;TABLE0_COL</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">_INDEXED&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">indexed</span><span class="p">)</span>
            <span class="n">args</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;TABLE0_COL</span><span class="si">{</span><span class="n">index</span><span class="si">}</span><span class="s2">_FLAGS&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">index</span> <span class="o">+</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">args</span></div>


<div class="viewcode-block" id="TapPlus.get_current_column_values_for_update">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.get_current_column_values_for_update">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_current_column_values_for_update</span><span class="p">(</span><span class="n">column</span><span class="p">):</span>
        <span class="n">column_name</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">name</span>
        <span class="n">flags</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">flags</span>
        <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;Ra&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;Dec&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;4&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;Flux&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;8&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;Mag&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;16&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;PK&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;33&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;Ra&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;34&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;Dec&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;38&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;Flux&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;40&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;Mag&#39;</span>
        <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;48&#39;</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="s1">&#39;PK&#39;</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">indexed</span> <span class="o">=</span> <span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">flag</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;indexed&#39;</span>
                   <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Ra&#39;</span>
                   <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;Dec&#39;</span>
                   <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">flags</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;PK&#39;</span><span class="p">)</span>
        <span class="n">ucd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">ucd</span><span class="p">)</span>
        <span class="n">utype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">column</span><span class="o">.</span><span class="n">utype</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">column_name</span><span class="p">,</span> <span class="n">flags</span><span class="p">,</span> <span class="n">indexed</span><span class="p">,</span> <span class="n">ucd</span><span class="p">,</span> <span class="n">utype</span></div>


<div class="viewcode-block" id="TapPlus.get_new_column_values_for_update">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.get_new_column_values_for_update">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">get_new_column_values_for_update</span><span class="p">(</span><span class="n">list_of_changes</span><span class="p">,</span> <span class="n">column_name</span><span class="p">,</span>
                                         <span class="n">c_flags</span><span class="p">,</span> <span class="n">c_indexed</span><span class="p">,</span> <span class="n">c_ucd</span><span class="p">,</span> <span class="n">c_utype</span><span class="p">):</span>
        <span class="n">found_new_flags</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">found_new_indexed</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">found_new_ucd</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">found_new_utype</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">n_flags</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">n_indexed</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">n_utype</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">n_ucd</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">list_of_changes</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">==</span> <span class="n">column_name</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;flags&#39;</span><span class="p">:</span>
                    <span class="n">n_flags</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">found_new_flags</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;indexed&#39;</span><span class="p">:</span>
                    <span class="n">n_indexed</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">found_new_indexed</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;ucd&#39;</span><span class="p">:</span>
                    <span class="n">n_ucd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">found_new_ucd</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="s1">&#39;utype&#39;</span><span class="p">:</span>
                    <span class="n">n_utype</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="n">found_new_utype</span> <span class="o">=</span> <span class="kc">True</span>

        <span class="k">if</span> <span class="n">found_new_ucd</span><span class="p">:</span>
            <span class="n">ucd</span> <span class="o">=</span> <span class="n">n_ucd</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ucd</span> <span class="o">=</span> <span class="n">c_ucd</span>

        <span class="k">if</span> <span class="n">found_new_utype</span><span class="p">:</span>
            <span class="n">utype</span> <span class="o">=</span> <span class="n">n_utype</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">utype</span> <span class="o">=</span> <span class="n">c_utype</span>

        <span class="k">if</span> <span class="n">found_new_indexed</span><span class="p">:</span>
            <span class="n">indexed</span> <span class="o">=</span> <span class="n">n_indexed</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">indexed</span> <span class="o">=</span> <span class="n">c_indexed</span>

        <span class="c1"># index could be updated</span>
        <span class="k">if</span> <span class="n">found_new_flags</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">n_flags</span> <span class="ow">is</span> <span class="kc">None</span> <span class="ow">or</span> <span class="n">n_flags</span> <span class="o">==</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">found_new_indexed</span><span class="p">:</span>
                    <span class="n">indexed</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">n_indexed</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">indexed</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="c1"># Index required for PK, Ra, Dec</span>
                <span class="k">if</span> <span class="n">c_flags</span> <span class="o">==</span> <span class="s1">&#39;Ra&#39;</span> <span class="ow">or</span> <span class="n">c_flags</span> <span class="o">==</span> <span class="s1">&#39;Dec&#39;</span> <span class="ow">or</span> <span class="n">c_flags</span> <span class="o">==</span> <span class="s1">&#39;PK&#39;</span><span class="p">:</span>
                    <span class="n">indexed</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="kc">True</span><span class="p">)</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="n">n_flags</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">flags</span> <span class="o">=</span> <span class="n">c_flags</span>

        <span class="k">return</span> <span class="n">flags</span><span class="p">,</span> <span class="n">indexed</span><span class="p">,</span> <span class="n">ucd</span><span class="p">,</span> <span class="n">utype</span></div>


<div class="viewcode-block" id="TapPlus.set_ra_dec_columns">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.set_ra_dec_columns">[docs]</a>
    <span class="k">def</span> <span class="nf">set_ra_dec_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">ra_column_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">dec_column_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Set columns of a table as ra and dec respectively a user table</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        table_name : str</span>
<span class="sd">            table to be set</span>
<span class="sd">        ra_column_name : str</span>
<span class="sd">            ra column to be set</span>
<span class="sd">        dec_column_name : str</span>
<span class="sd">            dec column to be set</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">if</span> <span class="n">table_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Table name cannot be null&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">ra_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Ra column name cannot be null&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">dec_column_name</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Dec column name cannot be null&quot;</span><span class="p">)</span>

        <span class="n">args</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;ACTION&quot;</span><span class="p">:</span> <span class="s2">&quot;radec&quot;</span><span class="p">,</span>
            <span class="s2">&quot;TABLE_NAME&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">table_name</span><span class="p">),</span>
            <span class="s2">&quot;RA&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">ra_column_name</span><span class="p">),</span>
            <span class="s2">&quot;DEC&quot;</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">dec_column_name</span><span class="p">),</span>
        <span class="p">}</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_table_edit</span><span class="p">(</span><span class="n">urlencode</span><span class="p">(</span><span class="n">args</span><span class="p">),</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                           <span class="n">verbose</span><span class="p">,</span>
                                                           <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
        <span class="n">msg</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;Table &#39;</span><span class="si">{</span><span class="n">table_name</span><span class="si">}</span><span class="s2">&#39; updated (ra/dec).&quot;</span>
        <span class="k">return</span> <span class="n">msg</span></div>


<div class="viewcode-block" id="TapPlus.login">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.login">[docs]</a>
    <span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs a login.</span>
<span class="sd">        User and password arguments can be used or a file that contains</span>
<span class="sd">        user name and password</span>
<span class="sd">        (2 lines: one for user name and the following one for the password).</span>
<span class="sd">        If no arguments are provided, a prompt asking for user name and</span>
<span class="sd">        password will appear.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user : str, default None</span>
<span class="sd">            login name</span>
<span class="sd">        password : str, default None</span>
<span class="sd">            user password</span>
<span class="sd">        credentials_file : str, default None</span>
<span class="sd">            file containing user and password in two lines</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">credentials_file</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># read file: get user &amp; password</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">credentials_file</span><span class="p">,</span> <span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">ins</span><span class="p">:</span>
                <span class="n">user</span> <span class="o">=</span> <span class="n">ins</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
                <span class="n">password</span> <span class="o">=</span> <span class="n">ins</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">user</span> <span class="o">=</span> <span class="nb">input</span><span class="p">(</span><span class="s2">&quot;User: &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">user</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Invalid user name&quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">password</span> <span class="o">=</span> <span class="n">getpass</span><span class="o">.</span><span class="n">getpass</span><span class="p">(</span><span class="s2">&quot;Password: &quot;</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">password</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Invalid password&quot;</span><span class="p">)</span>
                <span class="k">return</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__user</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">user</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__pwd</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">password</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__dologin</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


<div class="viewcode-block" id="TapPlus.login_gui">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.login_gui">[docs]</a>
    <span class="k">def</span> <span class="nf">login_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs a login using a GUI dialog</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">url</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">get_host_url</span><span class="p">()</span>
        <span class="n">loginDialog</span> <span class="o">=</span> <span class="n">LoginDialog</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
        <span class="n">loginDialog</span><span class="o">.</span><span class="n">show_login</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">loginDialog</span><span class="o">.</span><span class="n">is_accepted</span><span class="p">():</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__user</span> <span class="o">=</span> <span class="n">loginDialog</span><span class="o">.</span><span class="n">get_user</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__pwd</span> <span class="o">=</span> <span class="n">loginDialog</span><span class="o">.</span><span class="n">get_password</span><span class="p">()</span>
            <span class="c1"># execute login</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__dologin</span><span class="p">(</span><span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__isLoggedIn</span> <span class="o">=</span> <span class="kc">False</span></div>


    <span class="k">def</span> <span class="nf">__dologin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isLoggedIn</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__execLogin</span><span class="p">(</span><span class="n">usr</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__user</span><span class="p">,</span> <span class="n">pwd</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">__pwd</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="c1"># check response</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">isError</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">check_launch_response_status</span><span class="p">(</span><span class="n">response</span><span class="p">,</span>
                                                           <span class="n">verbose</span><span class="p">,</span>
                                                           <span class="mi">200</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">isError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Login error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="k">raise</span> <span class="n">requests</span><span class="o">.</span><span class="n">exceptions</span><span class="o">.</span><span class="n">HTTPError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Login error: </span><span class="si">{</span><span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># extract cookie</span>
            <span class="n">cookie</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tap__findCookieInHeader</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
            <span class="k">if</span> <span class="n">cookie</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">__isLoggedIn</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">connHandler</span><span class="o">.</span><span class="n">set_cookie</span><span class="p">(</span><span class="n">cookie</span><span class="p">)</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;OK&quot;</span><span class="p">)</span>

<div class="viewcode-block" id="TapPlus.logout">
<a class="viewcode-back" href="../../../../api/astroquery.utils.tap.TapPlus.html#astroquery.utils.tap.TapPlus.logout">[docs]</a>
    <span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs a logout</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">subContext</span> <span class="o">=</span> <span class="s2">&quot;logout&quot;</span>
        <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getconnhandler</span><span class="p">()</span>
        <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_secure</span><span class="p">(</span><span class="n">subContext</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">status</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">reason</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">getheaders</span><span class="p">())</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">__isLoggedIn</span> <span class="o">=</span> <span class="kc">False</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__columnsContainFlag</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">columns</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">:</span>
                <span class="n">f</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">flags</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;1&#39;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;33&#39;</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;Ra&#39;</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;2&#39;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;34&#39;</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;Dec&#39;</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;4&#39;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;38&#39;</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;Flux&#39;</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;8&#39;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;40&#39;</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;Mag&#39;</span>
                <span class="k">elif</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;16&#39;</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;48&#39;</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="s1">&#39;PK&#39;</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">f</span> <span class="o">=</span> <span class="kc">None</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">f</span><span class="p">):</span>
                    <span class="n">c</span> <span class="o">=</span> <span class="n">column</span><span class="o">.</span><span class="n">name</span>
                    <span class="k">break</span>
        <span class="k">return</span> <span class="n">c</span>

    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__changesContainFlag</span><span class="p">(</span><span class="o">*</span><span class="p">,</span> <span class="n">changes</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">flag</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">changes</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span> <span class="ow">and</span> <span class="nb">len</span><span class="p">(</span><span class="n">changes</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">change</span> <span class="ow">in</span> <span class="n">changes</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">==</span> <span class="s2">&quot;flags&quot;</span><span class="p">:</span>
                    <span class="n">value</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
                    <span class="k">if</span> <span class="nb">str</span><span class="p">(</span><span class="n">flag</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">(</span><span class="n">value</span><span class="p">):</span>
                        <span class="n">c</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">change</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                        <span class="k">break</span>
        <span class="k">return</span> <span class="n">c</span>

    <span class="k">def</span> <span class="nf">__getconnhandler</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Tap__connHandler</span></div>

</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, The Astroquery Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 11 Dec 2023. <br/>
  </p>
</footer>
  </body>
</html>