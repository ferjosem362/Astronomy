<!DOCTYPE html>

<html lang="en" data-content_root="../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>astroquery.gaia.core &#8212; astroquery v0.4.7.dev9024</title>
    <link rel="stylesheet" type="text/css" href="../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../_static/bootstrap-astropy.css?v=9d21690f" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    
    <script src="../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../_static/documentation_options.js?v=4195d067"></script>
    <script src="../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">query</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../index.html">astroquery v0.4.7.dev9024</a>
	 &#187;
      </li>
      <li><a href="../../index.html" >Module code</a> &#187;</li>
      <li><a href="../gaia.html" accesskey="U">astroquery.gaia</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for astroquery.gaia.core</h1><div class="highlight"><pre>
<span></span><span class="c1"># Licensed under a 3-clause BSD style license - see LICENSE.rst</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="sd">=============</span>
<span class="sd">Gaia TAP plus</span>
<span class="sd">=============</span>

<span class="sd">@author: Juan Carlos Segovia</span>
<span class="sd">@contact: juan.carlos.segovia@sciops.esa.int</span>

<span class="sd">European Space Astronomy Centre (ESAC)</span>
<span class="sd">European Space Agency (ESA)</span>

<span class="sd">Created on 30 jun. 2016</span>
<span class="sd">Modified on 18 Ene. 2022 by mhsarmiento</span>
<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">import</span> <span class="nn">zipfile</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">from</span> <span class="nn">datetime</span> <span class="kn">import</span> <span class="n">datetime</span><span class="p">,</span> <span class="n">timezone</span>
<span class="kn">import</span> <span class="nn">shutil</span>
<span class="kn">from</span> <span class="nn">collections.abc</span> <span class="kn">import</span> <span class="n">Iterable</span>

<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">Angle</span>
<span class="kn">from</span> <span class="nn">astropy.units</span> <span class="kn">import</span> <span class="n">Quantity</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">votable</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">requests</span> <span class="kn">import</span> <span class="n">HTTPError</span>

<span class="kn">from</span> <span class="nn">astroquery.utils.tap</span> <span class="kn">import</span> <span class="n">TapPlus</span>
<span class="kn">from</span> <span class="nn">astroquery.utils</span> <span class="kn">import</span> <span class="n">commons</span>
<span class="kn">from</span> <span class="nn">astroquery</span> <span class="kn">import</span> <span class="n">log</span>
<span class="kn">from</span> <span class="nn">astroquery.utils.tap</span> <span class="kn">import</span> <span class="n">taputils</span>
<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">conf</span>


<div class="viewcode-block" id="GaiaClass">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass">[docs]</a>
<span class="k">class</span> <span class="nc">GaiaClass</span><span class="p">(</span><span class="n">TapPlus</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Proxy class to default TapPlus object (pointing to Gaia Archive)</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="n">MAIN_GAIA_TABLE</span> <span class="o">=</span> <span class="kc">None</span>
    <span class="n">MAIN_GAIA_TABLE_RA</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE_RA</span>
    <span class="n">MAIN_GAIA_TABLE_DEC</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE_DEC</span>
    <span class="n">ROW_LIMIT</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">ROW_LIMIT</span>
    <span class="n">VALID_DATALINK_RETRIEVAL_TYPES</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">VALID_DATALINK_RETRIEVAL_TYPES</span>
    <span class="n">GAIA_MESSAGES</span> <span class="o">=</span> <span class="s2">&quot;notification?action=GetNotifications&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">tap_plus_conn_handler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">datalink_handler</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                 <span class="n">gaia_tap_server</span><span class="o">=</span><span class="s1">&#39;https://gea.esac.esa.int/&#39;</span><span class="p">,</span>
                 <span class="n">gaia_data_server</span><span class="o">=</span><span class="s1">&#39;https://gea.esac.esa.int/&#39;</span><span class="p">,</span>
                 <span class="n">tap_server_context</span><span class="o">=</span><span class="s2">&quot;tap-server&quot;</span><span class="p">,</span>
                 <span class="n">data_server_context</span><span class="o">=</span><span class="s2">&quot;data-server&quot;</span><span class="p">,</span>
                 <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">show_server_messages</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">GaiaClass</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">gaia_tap_server</span><span class="p">,</span>
                                        <span class="n">server_context</span><span class="o">=</span><span class="n">tap_server_context</span><span class="p">,</span>
                                        <span class="n">tap_context</span><span class="o">=</span><span class="s2">&quot;tap&quot;</span><span class="p">,</span>
                                        <span class="n">upload_context</span><span class="o">=</span><span class="s2">&quot;Upload&quot;</span><span class="p">,</span>
                                        <span class="n">table_edit_context</span><span class="o">=</span><span class="s2">&quot;TableTool&quot;</span><span class="p">,</span>
                                        <span class="n">data_context</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                        <span class="n">datalink_context</span><span class="o">=</span><span class="s2">&quot;datalink&quot;</span><span class="p">,</span>
                                        <span class="n">connhandler</span><span class="o">=</span><span class="n">tap_plus_conn_handler</span><span class="p">,</span>
                                        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="c1"># Data uses a different TapPlus connection</span>
        <span class="k">if</span> <span class="n">datalink_handler</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gaiadata</span> <span class="o">=</span> <span class="n">TapPlus</span><span class="p">(</span><span class="n">url</span><span class="o">=</span><span class="n">gaia_data_server</span><span class="p">,</span>
                                      <span class="n">server_context</span><span class="o">=</span><span class="n">data_server_context</span><span class="p">,</span>
                                      <span class="n">tap_context</span><span class="o">=</span><span class="s2">&quot;tap&quot;</span><span class="p">,</span>
                                      <span class="n">upload_context</span><span class="o">=</span><span class="s2">&quot;Upload&quot;</span><span class="p">,</span>
                                      <span class="n">table_edit_context</span><span class="o">=</span><span class="s2">&quot;TableTool&quot;</span><span class="p">,</span>
                                      <span class="n">data_context</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span>
                                      <span class="n">datalink_context</span><span class="o">=</span><span class="s2">&quot;datalink&quot;</span><span class="p">,</span>
                                      <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gaiadata</span> <span class="o">=</span> <span class="n">datalink_handler</span>

        <span class="c1"># Enable notifications</span>
        <span class="k">if</span> <span class="n">show_server_messages</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">get_status_messages</span><span class="p">()</span>

<div class="viewcode-block" id="GaiaClass.login">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.login">[docs]</a>
    <span class="k">def</span> <span class="nf">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">credentials_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs a login.</span>
<span class="sd">        User and password arguments can be used or a file that contains</span>
<span class="sd">        username and password</span>
<span class="sd">        (2 lines: one for username and the following one for the password).</span>
<span class="sd">        If no arguments are provided, a prompt asking for username and</span>
<span class="sd">        password will appear.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user : str, default None</span>
<span class="sd">            login name</span>
<span class="sd">        password : str, default None</span>
<span class="sd">            user password</span>
<span class="sd">        credentials_file : str, default None</span>
<span class="sd">            file containing user and password in two lines</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Login to gaia TAP server&quot;</span><span class="p">)</span>
            <span class="n">TapPlus</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">user</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">password</span><span class="p">,</span>
                          <span class="n">credentials_file</span><span class="o">=</span><span class="n">credentials_file</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">HTTPError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error logging in TAP server&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TapPlus__user</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TapPlus__pwd</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Login to gaia data server&quot;</span><span class="p">)</span>
            <span class="n">TapPlus</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__gaiadata</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">HTTPError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error logging in data server&quot;</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Logging out from TAP server&quot;</span><span class="p">)</span>
            <span class="n">TapPlus</span><span class="o">.</span><span class="n">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.login_gui">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.login_gui">[docs]</a>
    <span class="k">def</span> <span class="nf">login_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs a login using a GUI dialog</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Login to gaia TAP server&quot;</span><span class="p">)</span>
            <span class="n">TapPlus</span><span class="o">.</span><span class="n">login_gui</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">HTTPError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error logging in TAP server&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">u</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TapPlus__user</span>
        <span class="n">p</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TapPlus__pwd</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Login to gaia data server&quot;</span><span class="p">)</span>
            <span class="n">TapPlus</span><span class="o">.</span><span class="n">login</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__gaiadata</span><span class="p">,</span> <span class="n">user</span><span class="o">=</span><span class="n">u</span><span class="p">,</span> <span class="n">password</span><span class="o">=</span><span class="n">p</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">HTTPError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error logging in data server&quot;</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Logging out from TAP server&quot;</span><span class="p">)</span>
            <span class="n">TapPlus</span><span class="o">.</span><span class="n">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.logout">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.logout">[docs]</a>
    <span class="k">def</span> <span class="nf">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs a logout</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">TapPlus</span><span class="o">.</span><span class="n">logout</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">HTTPError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error logging out TAP server&quot;</span><span class="p">)</span>
            <span class="k">return</span>
        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Gaia TAP server logout OK&quot;</span><span class="p">)</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">TapPlus</span><span class="o">.</span><span class="n">logout</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__gaiadata</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Gaia data server logout OK&quot;</span><span class="p">)</span>
        <span class="k">except</span> <span class="n">HTTPError</span><span class="p">:</span>
            <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Error logging out data server&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.load_data">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.load_data">[docs]</a>
    <span class="k">def</span> <span class="nf">load_data</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">data_release</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">data_structure</span><span class="o">=</span><span class="s1">&#39;INDIVIDUAL&#39;</span><span class="p">,</span> <span class="n">retrieval_type</span><span class="o">=</span><span class="s2">&quot;ALL&quot;</span><span class="p">,</span>
                  <span class="n">linking_parameter</span><span class="o">=</span><span class="s1">&#39;SOURCE_ID&#39;</span><span class="p">,</span> <span class="n">valid_data</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">band</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">avoid_datatype_check</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span>
                  <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">overwrite_output_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the specified table</span>
<span class="sd">        TAP+ only</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ids : str list, mandatory</span>
<span class="sd">            list of identifiers</span>
<span class="sd">        data_release: str, optional, default None</span>
<span class="sd">            data release from which data should be taken. E.g. &#39;Gaia DR3&#39;</span>
<span class="sd">            By default, it takes the current default one.</span>
<span class="sd">        data_structure: str, optional, default &#39;INDIVIDUAL&#39;</span>
<span class="sd">            it can be &#39;INDIVIDUAL&#39;, &#39;COMBINED&#39;, &#39;RAW&#39;:</span>
<span class="sd">            &#39;INDIVIDUAL&#39; means products are provided in separate files for each sourceId. All files are zipped</span>
<span class="sd">            in a single bundle, even if only one source/file is considered</span>
<span class="sd">            &#39;COMBINED&#39; means products are provided in a single file concatenating the data of all sourceIds together.</span>
<span class="sd">            How this is organised depends on the chosen format</span>
<span class="sd">            &#39;RAW&#39; means products are provided following a Data Model similar to that used in the MDB, meaning in</span>
<span class="sd">            particular that parameters stored as arrays will remain as such. Like in the COMBINED structure, a single</span>
<span class="sd">            file is provided for the data of all sourceIds together, but in this case there will be always be one</span>
<span class="sd">            row per sourceId</span>
<span class="sd">        retrieval_type : str, optional, default &#39;ALL&#39; to retrieve all data  from the list of sources</span>
<span class="sd">            retrieval type identifier. For GAIA DR2 possible values are [&#39;EPOCH_PHOTOMETRY&#39;]</span>
<span class="sd">            For GAIA DR3, possible values are [&#39;EPOCH_PHOTOMETRY&#39;, &#39;RVS&#39;, &#39;XP_CONTINUOUS&#39;, &#39;XP_SAMPLED&#39;,</span>
<span class="sd">            &#39;MCMC_GSPPHOT&#39; or &#39;MCMC_MSC&#39;]</span>
<span class="sd">            For GAIA DR4, possible values will be [&#39;EPOCH_PHOTOMETRY&#39;, &#39;RVS&#39;, &#39;XP_CONTINUOUS&#39;, &#39;XP_SAMPLED&#39;,</span>
<span class="sd">            &#39;MCMC_GSPPHOT&#39;, &#39;MCMC_MSC&#39;, &#39;EPOCH_ASTROMETRY&#39;, &#39;RV_EPOCH_SINGLE&#39;, &#39;RV_EPOCH_DOUBLE&#39;, &#39;RVS_EPOCH&#39; or</span>
<span class="sd">            &#39;RVS_TRANSIT&#39;]</span>
<span class="sd">        linking_parameter : str, optional, default SOURCE_ID, valid values: SOURCE_ID, TRANSIT_ID, IMAGE_ID</span>
<span class="sd">            By default, all the identifiers are considered as source_id</span>
<span class="sd">            SOURCE_ID: the identifiers are considered as source_id</span>
<span class="sd">            TRANSIT_ID: the identifiers are considered as transit_id</span>
<span class="sd">            IMAGE_ID: the identifiers are considered as sif_observation_id</span>
<span class="sd">        valid_data : bool, optional, default False</span>
<span class="sd">            By default, the epoch photometry service returns all available data, including</span>
<span class="sd">            data rows where flux is null and/or the rejected_by_photometry flag is set to True.</span>
<span class="sd">            In order to retrieve only valid data (data rows where flux is not null and/or the</span>
<span class="sd">            rejected_by_photometry flag is set to False) this request parameter should be included</span>
<span class="sd">            with valid_data=True.</span>
<span class="sd">        band : str, optional, default None, valid values: G, BP, RP</span>
<span class="sd">            By default, the epoch photometry service returns all the</span>
<span class="sd">            available photometry bands for the requested source.</span>
<span class="sd">            This parameter allows to filter the output lightcurve by its band.</span>
<span class="sd">        avoid_datatype_check: boolean, optional, default False.</span>
<span class="sd">            By default, this value will be set to False. If it is set to &#39;true&#39;</span>
<span class="sd">            the Datalink items tags will not be checked.</span>
<span class="sd">        format : str, optional, default &#39;votable&#39;</span>
<span class="sd">            loading format. Other available formats are &#39;csv&#39;, &#39;ecsv&#39;,&#39;json&#39;,&#39;votable_plain&#39; and &#39;fits&#39;</span>
<span class="sd">        output_file : string, optional, default None</span>
<span class="sd">            file where the results are saved.</span>
<span class="sd">            If it is not provided, the http response contents are returned.</span>
<span class="sd">        overwrite_output_file : boolean, optional, default False</span>
<span class="sd">            To overwrite the output_file if it already exists.</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A table object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">now</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">now</span><span class="p">(</span><span class="n">timezone</span><span class="o">.</span><span class="n">utc</span><span class="p">)</span>
        <span class="n">now_formatted</span> <span class="o">=</span> <span class="n">now</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s2">&quot;%Y%m</span><span class="si">%d</span><span class="s2">_%H%M%S&quot;</span><span class="p">)</span>
        <span class="n">temp_dirname</span> <span class="o">=</span> <span class="s2">&quot;temp_&quot;</span> <span class="o">+</span> <span class="n">now_formatted</span>
        <span class="n">downloadname_formated</span> <span class="o">=</span> <span class="s2">&quot;download_&quot;</span> <span class="o">+</span> <span class="n">now_formatted</span>

        <span class="n">output_file_specified</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">if</span> <span class="n">output_file</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="n">temp_dirname</span><span class="p">,</span> <span class="n">downloadname_formated</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">output_file_specified</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="n">output_file</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">abspath</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">overwrite_output_file</span> <span class="ow">and</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">output_file</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">output_file</span><span class="si">}</span><span class="s2"> file already exists. Please use overwrite_output_file=&#39;True&#39; to &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;overwrite output file.&quot;</span><span class="p">)</span>

        <span class="n">path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output_file</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">avoid_datatype_check</span> <span class="ow">is</span> <span class="kc">False</span><span class="p">:</span>
            <span class="c1"># we need to check params</span>
            <span class="n">rt</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">retrieval_type</span><span class="p">)</span><span class="o">.</span><span class="n">upper</span><span class="p">()</span>
            <span class="k">if</span> <span class="n">rt</span> <span class="o">!=</span> <span class="s1">&#39;ALL&#39;</span> <span class="ow">and</span> <span class="n">rt</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">VALID_DATALINK_RETRIEVAL_TYPES</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid mandatory argument &#39;retrieval_type&#39;. Found </span><span class="si">{</span><span class="n">retrieval_type</span><span class="si">}</span><span class="s2">, &quot;</span>
                                 <span class="sa">f</span><span class="s2">&quot;expected: &#39;ALL&#39; or any of </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">VALID_DATALINK_RETRIEVAL_TYPES</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">params_dict</span> <span class="o">=</span> <span class="p">{}</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">valid_data</span> <span class="ow">or</span> <span class="nb">str</span><span class="p">(</span><span class="n">retrieval_type</span><span class="p">)</span> <span class="o">==</span> <span class="s1">&#39;ALL&#39;</span><span class="p">:</span>
            <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;VALID_DATA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;false&quot;</span>
        <span class="k">elif</span> <span class="n">valid_data</span><span class="p">:</span>
            <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;VALID_DATA&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;true&quot;</span>

        <span class="k">if</span> <span class="n">band</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">band</span> <span class="o">!=</span> <span class="s1">&#39;G&#39;</span> <span class="ow">and</span> <span class="n">band</span> <span class="o">!=</span> <span class="s1">&#39;BP&#39;</span> <span class="ow">and</span> <span class="n">band</span> <span class="o">!=</span> <span class="s1">&#39;RP&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid band value &#39;</span><span class="si">{</span><span class="n">band</span><span class="si">}</span><span class="s2">&#39; (Valid values: &#39;G&#39;, &#39;BP&#39; and &#39;RP)&quot;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;BAND&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">band</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">ids_arg</span> <span class="o">=</span> <span class="n">ids</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">ids</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
                <span class="n">ids_arg</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">ids</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">ids_arg</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">item</span><span class="p">)</span> <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">ids</span><span class="p">)</span>
        <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;ID&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">ids_arg</span>
        <span class="k">if</span> <span class="n">data_release</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;RELEASE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_release</span>
        <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;DATA_STRUCTURE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">data_structure</span>
        <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;FORMAT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="nb">format</span><span class="p">)</span>
        <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;RETRIEVAL_TYPE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">retrieval_type</span><span class="p">)</span>
        <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;USE_ZIP_ALWAYS&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;true&#39;</span>

        <span class="n">valid_param</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;SOURCE_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;TRANSIT_ID&#39;</span><span class="p">,</span> <span class="s1">&#39;IMAGE_ID&#39;</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">linking_parameter</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">valid_param</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="sa">f</span><span class="s2">&quot;Invalid linking_parameter value &#39;</span><span class="si">{</span><span class="n">linking_parameter</span><span class="si">}</span><span class="s2">&#39; (Valid values: </span><span class="si">{</span><span class="s1">&#39;, &#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">valid_param</span><span class="p">)</span><span class="si">}</span><span class="s2">)&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">linking_parameter</span> <span class="o">!=</span> <span class="s1">&#39;SOURCE_ID&#39;</span><span class="p">:</span>
                <span class="n">params_dict</span><span class="p">[</span><span class="s1">&#39;LINKING_PARAMETER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">linking_parameter</span>

        <span class="k">if</span> <span class="n">path</span> <span class="o">!=</span> <span class="s1">&#39;&#39;</span><span class="p">:</span>
            <span class="k">try</span><span class="p">:</span>
                <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">FileExistsError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Path </span><span class="si">%s</span><span class="s2"> already exist&quot;</span> <span class="o">%</span> <span class="n">path</span><span class="p">)</span>
            <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">error</span><span class="p">(</span><span class="s2">&quot;Creation of the directory </span><span class="si">%s</span><span class="s2"> failed&quot;</span> <span class="o">%</span> <span class="n">path</span><span class="p">)</span>

        <span class="k">try</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">__gaiadata</span><span class="o">.</span><span class="n">load_data</span><span class="p">(</span><span class="n">params_dict</span><span class="o">=</span><span class="n">params_dict</span><span class="p">,</span>
                                      <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                      <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="n">files</span> <span class="o">=</span> <span class="n">Gaia</span><span class="o">.</span><span class="n">__get_data_files</span><span class="p">(</span><span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span> <span class="n">path</span><span class="o">=</span><span class="n">path</span><span class="p">)</span>
        <span class="k">except</span> <span class="ne">Exception</span> <span class="k">as</span> <span class="n">err</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">err</span>
        <span class="k">finally</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">output_file_specified</span><span class="p">:</span>
                <span class="n">shutil</span><span class="o">.</span><span class="n">rmtree</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">output_file_specified</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;output_file = </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">output_file</span><span class="p">)</span>

        <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;List of products available:&quot;</span><span class="p">)</span>
        <span class="c1"># for key, value in files.items():</span>
        <span class="c1"># print(&quot;Product =&quot;, key)</span>

        <span class="n">items</span> <span class="o">=</span> <span class="nb">sorted</span><span class="p">([</span><span class="n">key</span> <span class="k">for</span> <span class="n">key</span> <span class="ow">in</span> <span class="n">files</span><span class="o">.</span><span class="n">keys</span><span class="p">()])</span>
        <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">items</span><span class="p">:</span>
            <span class="c1"># print(f&#39;* {item}&#39;)</span>
            <span class="k">if</span> <span class="n">verbose</span><span class="p">:</span>
                <span class="n">log</span><span class="o">.</span><span class="n">debug</span><span class="p">(</span><span class="s2">&quot;Product = &quot;</span> <span class="o">+</span> <span class="n">item</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">files</span></div>


    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">__get_data_files</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
        <span class="n">files</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">is_zipfile</span><span class="p">(</span><span class="n">output_file</span><span class="p">):</span>
            <span class="k">with</span> <span class="n">zipfile</span><span class="o">.</span><span class="n">ZipFile</span><span class="p">(</span><span class="n">output_file</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">zip_ref</span><span class="p">:</span>
                <span class="n">zip_ref</span><span class="o">.</span><span class="n">extractall</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">dirname</span><span class="p">(</span><span class="n">output_file</span><span class="p">))</span>

        <span class="c1"># r=root, d=directories, f = files</span>
        <span class="k">for</span> <span class="n">r</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">walk</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
            <span class="k">for</span> <span class="n">file</span> <span class="ow">in</span> <span class="n">f</span><span class="p">:</span>
                <span class="k">if</span> <span class="s1">&#39;.fits&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;.xml&#39;</span> <span class="ow">in</span> <span class="n">file</span> <span class="ow">or</span> <span class="s1">&#39;.csv&#39;</span> <span class="ow">in</span> <span class="n">file</span><span class="p">:</span>
                    <span class="n">files</span><span class="p">[</span><span class="n">file</span><span class="p">]</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">r</span><span class="p">,</span> <span class="n">file</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">files</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
            <span class="k">if</span> <span class="s1">&#39;.fits&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="k">as</span> <span class="n">hduList</span><span class="p">:</span>
                    <span class="c1"># print(hduList)</span>
                    <span class="n">num_hdus</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">hduList</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_hdus</span><span class="p">):</span>
                        <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">hduList</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>
                        <span class="n">Gaia</span><span class="o">.</span><span class="n">correct_table_units</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                        <span class="n">tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                    <span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tables</span>
            <span class="k">elif</span> <span class="s1">&#39;.xml&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="k">for</span> <span class="n">table</span> <span class="ow">in</span> <span class="n">votable</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span><span class="o">.</span><span class="n">iter_tables</span><span class="p">():</span>
                    <span class="n">tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                <span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tables</span>

            <span class="k">elif</span> <span class="s1">&#39;.csv&#39;</span> <span class="ow">in</span> <span class="n">key</span><span class="p">:</span>
                <span class="n">tables</span> <span class="o">=</span> <span class="p">[]</span>
                <span class="n">table</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.csv&#39;</span><span class="p">,</span>
                                   <span class="n">fast_reader</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
                <span class="n">tables</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">table</span><span class="p">)</span>
                <span class="n">files</span><span class="p">[</span><span class="n">key</span><span class="p">]</span> <span class="o">=</span> <span class="n">tables</span>
        <span class="k">return</span> <span class="n">files</span>

<div class="viewcode-block" id="GaiaClass.get_datalinks">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.get_datalinks">[docs]</a>
    <span class="k">def</span> <span class="nf">get_datalinks</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ids</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets datalinks associated to the provided identifiers</span>
<span class="sd">        TAP+ only</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        ids : str list, mandatory</span>
<span class="sd">            list of identifiers</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A table object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__gaiadata</span><span class="o">.</span><span class="n">get_datalinks</span><span class="p">(</span><span class="n">ids</span><span class="o">=</span><span class="n">ids</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__query_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                       <span class="n">async_job</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launches a job</span>
<span class="sd">        TAP &amp; TAP+</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinate : astropy.coordinate, mandatory</span>
<span class="sd">            coordinates center point</span>
<span class="sd">        radius : astropy.units if no &#39;width&#39; nor &#39;height&#39; are provided</span>
<span class="sd">            radius (deg)</span>
<span class="sd">        width : astropy.units if no &#39;radius&#39; is provided</span>
<span class="sd">            box width</span>
<span class="sd">        height : astropy.units if no &#39;radius&#39; is provided</span>
<span class="sd">            box height</span>
<span class="sd">        async_job : bool, optional, default &#39;False&#39;</span>
<span class="sd">            executes the query (job) in asynchronous/synchronous mode (default</span>
<span class="sd">            synchronous)</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        columns: list, optional, default []</span>
<span class="sd">            if empty, all columns will be selected</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        The job results (astropy.table).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getCoordInput</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span> <span class="s2">&quot;coordinate&quot;</span><span class="p">)</span>
        <span class="n">job</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cone_search</span><span class="p">(</span><span class="n">coord</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="n">async_job</span><span class="o">=</span><span class="n">async_job</span><span class="p">,</span>
                                     <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">raHours</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">commons</span><span class="o">.</span><span class="n">coord_to_radec</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
            <span class="n">ra</span> <span class="o">=</span> <span class="n">raHours</span> <span class="o">*</span> <span class="mf">15.0</span>  <span class="c1"># Converts to degrees</span>
            <span class="n">widthQuantity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getQuantityInput</span><span class="p">(</span><span class="n">width</span><span class="p">,</span> <span class="s2">&quot;width&quot;</span><span class="p">)</span>
            <span class="n">heightQuantity</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getQuantityInput</span><span class="p">(</span><span class="n">height</span><span class="p">,</span> <span class="s2">&quot;height&quot;</span><span class="p">)</span>
            <span class="n">widthDeg</span> <span class="o">=</span> <span class="n">widthQuantity</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
            <span class="n">heightDeg</span> <span class="o">=</span> <span class="n">heightQuantity</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="n">units</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>

            <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">columns</span><span class="p">))</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">columns</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>

            <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                    SELECT</span>
<span class="s2">                      </span><span class="si">{row_limit}</span>
<span class="s2">                      DISTANCE(</span>
<span class="s2">                        POINT(&#39;ICRS&#39;, </span><span class="si">{ra_column}</span><span class="s2">, </span><span class="si">{dec_column}</span><span class="s2">),</span>
<span class="s2">                        POINT(&#39;ICRS&#39;, </span><span class="si">{ra}</span><span class="s2">, </span><span class="si">{dec}</span><span class="s2">)</span>
<span class="s2">                      ) as dist,</span>
<span class="s2">                      </span><span class="si">{columns}</span>
<span class="s2">                    FROM</span>
<span class="s2">                      </span><span class="si">{table_name}</span>
<span class="s2">                    WHERE</span>
<span class="s2">                      1 = CONTAINS(</span>
<span class="s2">                        POINT(&#39;ICRS&#39;, </span><span class="si">{ra_column}</span><span class="s2">, </span><span class="si">{dec_column}</span><span class="s2">),</span>
<span class="s2">                        BOX(</span>
<span class="s2">                          &#39;ICRS&#39;,</span>
<span class="s2">                          </span><span class="si">{ra}</span><span class="s2">,</span>
<span class="s2">                          </span><span class="si">{dec}</span><span class="s2">,</span>
<span class="s2">                          </span><span class="si">{width}</span><span class="s2">,</span>
<span class="s2">                          </span><span class="si">{height}</span>
<span class="s2">                        )</span>
<span class="s2">                      )</span>
<span class="s2">                    ORDER BY</span>
<span class="s2">                      dist ASC</span>
<span class="s2">                    &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;row_limit&#39;</span><span class="p">:</span> <span class="s2">&quot;TOP </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ROW_LIMIT</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROW_LIMIT</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                                  <span class="s1">&#39;ra_column&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE_RA</span><span class="p">,</span> <span class="s1">&#39;dec_column&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE_DEC</span><span class="p">,</span>
                                  <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;table_name&#39;</span><span class="p">:</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE</span> <span class="ow">or</span> <span class="n">conf</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE</span><span class="p">,</span>
                                  <span class="s1">&#39;ra&#39;</span><span class="p">:</span> <span class="n">ra</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">:</span> <span class="n">dec</span><span class="p">,</span>
                                  <span class="s1">&#39;width&#39;</span><span class="p">:</span> <span class="n">widthDeg</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="s1">&#39;height&#39;</span><span class="p">:</span> <span class="n">heightDeg</span><span class="o">.</span><span class="n">value</span><span class="p">})</span>
            <span class="k">if</span> <span class="n">async_job</span><span class="p">:</span>
                <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">launch_job_async</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">job</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">launch_job</span><span class="p">(</span><span class="n">query</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">job</span><span class="o">.</span><span class="n">get_results</span><span class="p">()</span>

<div class="viewcode-block" id="GaiaClass.query_object">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.query_object">[docs]</a>
    <span class="k">def</span> <span class="nf">query_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launches a job</span>
<span class="sd">        TAP &amp; TAP+</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinate : astropy.coordinates, mandatory</span>
<span class="sd">            coordinates center point</span>
<span class="sd">        radius : astropy.units if no &#39;width&#39;/&#39;height&#39; are provided</span>
<span class="sd">            radius (deg)</span>
<span class="sd">        width : astropy.units if no &#39;radius&#39; is provided</span>
<span class="sd">            box width</span>
<span class="sd">        height : astropy.units if no &#39;radius&#39; is provided</span>
<span class="sd">            box height</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        columns: list, optional, default []</span>
<span class="sd">            if empty, all columns will be selected</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        The job results (astropy.table).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__query_object</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
                                   <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">async_job</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                   <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.query_object_async">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.query_object_async">[docs]</a>
    <span class="k">def</span> <span class="nf">query_object_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                           <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launches a job (async)</span>
<span class="sd">        TAP &amp; TAP+</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinate : astropy.coordinates, mandatory</span>
<span class="sd">            coordinates center point</span>
<span class="sd">        radius : astropy.units if no &#39;width&#39;/&#39;height&#39; are provided</span>
<span class="sd">            radius</span>
<span class="sd">        width : astropy.units if no &#39;radius&#39; is provided</span>
<span class="sd">            box width</span>
<span class="sd">        height : astropy.units if no &#39;radius&#39; is provided</span>
<span class="sd">            box height</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        columns: list, optional, default []</span>
<span class="sd">            if empty, all columns will be selected</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        The job results (astropy.table).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__query_object</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="n">width</span><span class="p">,</span>
                                   <span class="n">height</span><span class="o">=</span><span class="n">height</span><span class="p">,</span> <span class="n">async_job</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                   <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__cone_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">,</span> <span class="n">radius</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                      <span class="n">ra_column_name</span><span class="o">=</span><span class="n">MAIN_GAIA_TABLE_RA</span><span class="p">,</span>
                      <span class="n">dec_column_name</span><span class="o">=</span><span class="n">MAIN_GAIA_TABLE_DEC</span><span class="p">,</span>
                      <span class="n">async_job</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">background</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                      <span class="n">columns</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cone search sorted by distance</span>
<span class="sd">        TAP &amp; TAP+</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinate : astropy.coordinate, mandatory</span>
<span class="sd">            coordinates center point</span>
<span class="sd">        radius : astropy.units, mandatory</span>
<span class="sd">            radius</span>
<span class="sd">        table_name : str, optional, default main gaia table name doing the cone search against</span>
<span class="sd">        ra_column_name : str, optional, default ra column in main gaia table</span>
<span class="sd">            ra column doing the cone search against</span>
<span class="sd">        dec_column_name : str, optional, default dec column in main gaia table</span>
<span class="sd">            dec column doing the cone search against</span>
<span class="sd">        async_job : bool, optional, default &#39;False&#39;</span>
<span class="sd">            executes the job in asynchronous/synchronous mode (default</span>
<span class="sd">            synchronous)</span>
<span class="sd">        background : bool, optional, default &#39;False&#39;</span>
<span class="sd">            when the job is executed in asynchronous mode, this flag specifies</span>
<span class="sd">            whether the execution will wait until results are available</span>
<span class="sd">        output_file : str, optional, default None</span>
<span class="sd">            file name where the results are saved if dumpToFile is True.</span>
<span class="sd">            If this parameter is not provided, the jobid is used instead</span>
<span class="sd">        output_format : str, optional, default &#39;votable&#39;</span>
<span class="sd">            results format</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        dump_to_file : bool, optional, default &#39;False&#39;</span>
<span class="sd">            if True, the results are saved in a file instead of using memory</span>
<span class="sd">        columns: list, optional, default []</span>
<span class="sd">            if empty, all columns will be selected</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Job object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">radiusDeg</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="n">coord</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">__getCoordInput</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span> <span class="s2">&quot;coordinate&quot;</span><span class="p">)</span>
        <span class="n">raHours</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">commons</span><span class="o">.</span><span class="n">coord_to_radec</span><span class="p">(</span><span class="n">coord</span><span class="p">)</span>
        <span class="n">ra</span> <span class="o">=</span> <span class="n">raHours</span> <span class="o">*</span> <span class="mf">15.0</span>  <span class="c1"># Converts to degrees</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">radiusDeg</span> <span class="o">=</span> <span class="n">Angle</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">__getQuantityInput</span><span class="p">(</span><span class="n">radius</span><span class="p">,</span> <span class="s2">&quot;radius&quot;</span><span class="p">))</span><span class="o">.</span><span class="n">to_value</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">columns</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="s1">&#39;,&#39;</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="nb">map</span><span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="n">columns</span><span class="p">))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">columns</span> <span class="o">=</span> <span class="s2">&quot;*&quot;</span>

        <span class="n">query</span> <span class="o">=</span> <span class="s2">&quot;&quot;&quot;</span>
<span class="s2">                SELECT</span>
<span class="s2">                  </span><span class="si">{row_limit}</span>
<span class="s2">                  </span><span class="si">{columns}</span><span class="s2">,</span>
<span class="s2">                  DISTANCE(</span>
<span class="s2">                    POINT(&#39;ICRS&#39;, </span><span class="si">{ra_column}</span><span class="s2">, </span><span class="si">{dec_column}</span><span class="s2">),</span>
<span class="s2">                    POINT(&#39;ICRS&#39;, </span><span class="si">{ra}</span><span class="s2">, </span><span class="si">{dec}</span><span class="s2">)</span>
<span class="s2">                  ) AS dist</span>
<span class="s2">                FROM</span>
<span class="s2">                  </span><span class="si">{table_name}</span>
<span class="s2">                WHERE</span>
<span class="s2">                  1 = CONTAINS(</span>
<span class="s2">                    POINT(&#39;ICRS&#39;, </span><span class="si">{ra_column}</span><span class="s2">, </span><span class="si">{dec_column}</span><span class="s2">),</span>
<span class="s2">                    CIRCLE(&#39;ICRS&#39;, </span><span class="si">{ra}</span><span class="s2">, </span><span class="si">{dec}</span><span class="s2">, </span><span class="si">{radius}</span><span class="s2">)</span>
<span class="s2">                  )</span>
<span class="s2">                ORDER BY</span>
<span class="s2">                  dist ASC</span>
<span class="s2">                &quot;&quot;&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="p">{</span><span class="s1">&#39;ra_column&#39;</span><span class="p">:</span> <span class="n">ra_column_name</span><span class="p">,</span>
                              <span class="s1">&#39;row_limit&#39;</span><span class="p">:</span> <span class="s2">&quot;TOP </span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ROW_LIMIT</span><span class="p">)</span> <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">ROW_LIMIT</span> <span class="o">&gt;</span> <span class="mi">0</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
                              <span class="s1">&#39;dec_column&#39;</span><span class="p">:</span> <span class="n">dec_column_name</span><span class="p">,</span> <span class="s1">&#39;columns&#39;</span><span class="p">:</span> <span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;ra&#39;</span><span class="p">:</span> <span class="n">ra</span><span class="p">,</span> <span class="s1">&#39;dec&#39;</span><span class="p">:</span> <span class="n">dec</span><span class="p">,</span>
                              <span class="s1">&#39;radius&#39;</span><span class="p">:</span> <span class="n">radiusDeg</span><span class="p">,</span>
                              <span class="s1">&#39;table_name&#39;</span><span class="p">:</span> <span class="n">table_name</span> <span class="ow">or</span> <span class="bp">self</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE</span> <span class="ow">or</span> <span class="n">conf</span><span class="o">.</span><span class="n">MAIN_GAIA_TABLE</span><span class="p">})</span>

        <span class="k">if</span> <span class="n">async_job</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">launch_job_async</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                         <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                         <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                                         <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                         <span class="n">dump_to_file</span><span class="o">=</span><span class="n">dump_to_file</span><span class="p">,</span>
                                         <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">launch_job</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                   <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                   <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                                   <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                   <span class="n">dump_to_file</span><span class="o">=</span><span class="n">dump_to_file</span><span class="p">)</span>

<div class="viewcode-block" id="GaiaClass.cone_search">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.cone_search">[docs]</a>
    <span class="k">def</span> <span class="nf">cone_search</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">ra_column_name</span><span class="o">=</span><span class="n">MAIN_GAIA_TABLE_RA</span><span class="p">,</span>
                    <span class="n">dec_column_name</span><span class="o">=</span><span class="n">MAIN_GAIA_TABLE_DEC</span><span class="p">,</span>
                    <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">columns</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cone search sorted by distance (sync.)</span>
<span class="sd">        TAP &amp; TAP+</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinate : astropy.coordinate, mandatory</span>
<span class="sd">            coordinates center point</span>
<span class="sd">        radius : astropy.units, mandatory</span>
<span class="sd">            radius</span>
<span class="sd">        table_name : str, optional, default main gaia table name doing the cone search against</span>
<span class="sd">        ra_column_name : str, optional, default ra column in main gaia table</span>
<span class="sd">            ra column doing the cone search against</span>
<span class="sd">        dec_column_name : str, optional, default dec column in main gaia table</span>
<span class="sd">            dec column doing the cone search against</span>
<span class="sd">        output_file : str, optional, default None</span>
<span class="sd">            file name where the results are saved if dumpToFile is True.</span>
<span class="sd">            If this parameter is not provided, the jobid is used instead</span>
<span class="sd">        output_format : str, optional, default &#39;votable&#39;</span>
<span class="sd">            results format</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        dump_to_file : bool, optional, default &#39;False&#39;</span>
<span class="sd">            if True, the results are saved in a file instead of using memory</span>
<span class="sd">        columns: list, optional, default []</span>
<span class="sd">            if empty, all columns will be selected</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Job object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cone_search</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span>
                                  <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
                                  <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
                                  <span class="n">ra_column_name</span><span class="o">=</span><span class="n">ra_column_name</span><span class="p">,</span>
                                  <span class="n">dec_column_name</span><span class="o">=</span><span class="n">dec_column_name</span><span class="p">,</span>
                                  <span class="n">async_job</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">background</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                  <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                  <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                                  <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                  <span class="n">dump_to_file</span><span class="o">=</span><span class="n">dump_to_file</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.cone_search_async">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.cone_search_async">[docs]</a>
    <span class="k">def</span> <span class="nf">cone_search_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">coordinate</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                          <span class="n">ra_column_name</span><span class="o">=</span><span class="n">MAIN_GAIA_TABLE_RA</span><span class="p">,</span>
                          <span class="n">dec_column_name</span><span class="o">=</span><span class="n">MAIN_GAIA_TABLE_DEC</span><span class="p">,</span>
                          <span class="n">background</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                          <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span>
                          <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="p">[]):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Cone search sorted by distance (async)</span>
<span class="sd">        TAP &amp; TAP+</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        coordinate : astropy.coordinate, mandatory</span>
<span class="sd">            coordinates center point</span>
<span class="sd">        radius : astropy.units, mandatory</span>
<span class="sd">            radius</span>
<span class="sd">        table_name : str, optional, default main gaia table name doing the cone search against</span>
<span class="sd">        ra_column_name : str, optional, default ra column in main gaia table</span>
<span class="sd">            ra column doing the cone search against</span>
<span class="sd">        dec_column_name : str, optional, default dec column in main gaia table</span>
<span class="sd">            dec column doing the cone search against</span>
<span class="sd">        background : bool, optional, default &#39;False&#39;</span>
<span class="sd">            when the job is executed in asynchronous mode, this flag</span>
<span class="sd">            specifies whether</span>
<span class="sd">            the execution will wait until results are available</span>
<span class="sd">        output_file : str, optional, default None</span>
<span class="sd">            file name where the results are saved if dumpToFile is True.</span>
<span class="sd">            If this parameter is not provided, the jobid is used instead</span>
<span class="sd">        output_format : str, optional, default &#39;votable&#39;</span>
<span class="sd">            results format</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        dump_to_file : bool, optional, default &#39;False&#39;</span>
<span class="sd">            if True, the results are saved in a file instead of using memory</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Job object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">__cone_search</span><span class="p">(</span><span class="n">coordinate</span><span class="p">,</span>
                                  <span class="n">radius</span><span class="o">=</span><span class="n">radius</span><span class="p">,</span>
                                  <span class="n">table_name</span><span class="o">=</span><span class="n">table_name</span><span class="p">,</span>
                                  <span class="n">ra_column_name</span><span class="o">=</span><span class="n">ra_column_name</span><span class="p">,</span>
                                  <span class="n">dec_column_name</span><span class="o">=</span><span class="n">dec_column_name</span><span class="p">,</span>
                                  <span class="n">async_job</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                                  <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span>
                                  <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                  <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                                  <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                  <span class="n">dump_to_file</span><span class="o">=</span><span class="n">dump_to_file</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">)</span></div>


    <span class="k">def</span> <span class="nf">__checkQuantityInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> must be either a string or astropy coordinates&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getQuantityInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">value</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Missing required argument: </span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">units</span><span class="o">.</span><span class="n">Quantity</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> must be either a string or astropy.coordinates&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">q</span> <span class="o">=</span> <span class="n">Quantity</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">q</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

    <span class="k">def</span> <span class="nf">__checkCoordInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                     <span class="n">commons</span><span class="o">.</span><span class="n">CoordClasses</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> must be either a string or astropy.coordinates&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">__getCoordInput</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">msg</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="p">(</span><span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span>
                                                     <span class="n">commons</span><span class="o">.</span><span class="n">CoordClasses</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">msg</span><span class="si">}</span><span class="s2"> must be either a string or astropy.coordinates&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="n">c</span> <span class="o">=</span> <span class="n">commons</span><span class="o">.</span><span class="n">parse_coordinates</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
            <span class="k">return</span> <span class="n">c</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">value</span>

<div class="viewcode-block" id="GaiaClass.correct_table_units">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.correct_table_units">[docs]</a>
    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">correct_table_units</span><span class="p">(</span><span class="n">table</span><span class="p">):</span>
        <span class="k">for</span> <span class="n">cn</span> <span class="ow">in</span> <span class="n">table</span><span class="o">.</span><span class="n">colnames</span><span class="p">:</span>
            <span class="n">col</span> <span class="o">=</span> <span class="n">table</span><span class="p">[</span><span class="n">cn</span><span class="p">]</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">UnrecognizedUnit</span><span class="p">):</span>
                <span class="k">try</span><span class="p">:</span>
                    <span class="n">col</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">name</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">))</span>
                <span class="k">except</span> <span class="ne">Exception</span><span class="p">:</span>
                    <span class="k">pass</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">col</span><span class="o">.</span><span class="n">unit</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="n">col</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">col</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">,</span> <span class="s2">&quot; &quot;</span><span class="p">)</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="s2">&quot;&#39;&quot;</span><span class="p">,</span> <span class="s2">&quot;&quot;</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.load_user">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.load_user">[docs]</a>
    <span class="k">def</span> <span class="nf">load_user</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">user_id</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Loads the specified user</span>
<span class="sd">        TAP+ only</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        user_id : str, mandatory</span>
<span class="sd">            user id to load</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A user</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">is_valid_user</span><span class="p">(</span><span class="n">user_id</span><span class="o">=</span><span class="n">user_id</span><span class="p">,</span>
                                  <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.cross_match">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.cross_match">[docs]</a>
    <span class="k">def</span> <span class="nf">cross_match</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">full_qualified_table_name_a</span><span class="p">,</span>
                    <span class="n">full_qualified_table_name_b</span><span class="p">,</span>
                    <span class="n">results_table_name</span><span class="p">,</span>
                    <span class="n">radius</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
                    <span class="n">background</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                    <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Performs a cross-match between the specified tables</span>
<span class="sd">        The result is a join table (stored in the user storage area)</span>
<span class="sd">        with the identifies of both tables and the distance.</span>
<span class="sd">        TAP+ only</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        full_qualified_table_name_a : str, mandatory</span>
<span class="sd">            a full qualified table name (i.e. schema name and table name)</span>
<span class="sd">        full_qualified_table_name_b : str, mandatory</span>
<span class="sd">            a full qualified table name (i.e. schema name and table name)</span>
<span class="sd">        results_table_name : str, mandatory</span>
<span class="sd">            a table name without schema. The schema is set to the user one</span>
<span class="sd">        radius : float (arc. seconds), optional, default 1.0</span>
<span class="sd">            radius  (valid range: 0.1-10.0)</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        Boolean indicating if the specified user is valid</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">radius</span> <span class="o">&lt;</span> <span class="mf">0.1</span> <span class="ow">or</span> <span class="n">radius</span> <span class="o">&gt;</span> <span class="mf">10.0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Invalid radius value. Found </span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">, valid range is: 0.1 to 10.0&quot;</span><span class="p">)</span>

        <span class="n">schemaA</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_schema_name</span><span class="p">(</span><span class="n">full_qualified_table_name_a</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">schemaA</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Not found schema name in full qualified table A: &#39;</span><span class="si">{</span><span class="n">full_qualified_table_name_a</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>
        <span class="n">tableA</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_table_name</span><span class="p">(</span><span class="n">full_qualified_table_name_a</span><span class="p">)</span>
        <span class="n">schemaB</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_schema_name</span><span class="p">(</span><span class="n">full_qualified_table_name_b</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">schemaB</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Not found schema name in full qualified table B: &#39;</span><span class="si">{</span><span class="n">full_qualified_table_name_b</span><span class="si">}</span><span class="s2">&#39;&quot;</span><span class="p">)</span>

        <span class="n">tableB</span> <span class="o">=</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_table_name</span><span class="p">(</span><span class="n">full_qualified_table_name_b</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">taputils</span><span class="o">.</span><span class="n">get_schema_name</span><span class="p">(</span><span class="n">results_table_name</span><span class="p">)</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Please, do not specify schema for &#39;results_table_name&#39;&quot;</span><span class="p">)</span>

        <span class="n">query</span> <span class="o">=</span> <span class="sa">f</span><span class="s2">&quot;SELECT crossmatch_positional(&#39;</span><span class="si">{</span><span class="n">schemaA</span><span class="si">}</span><span class="s2">&#39;,&#39;</span><span class="si">{</span><span class="n">tableA</span><span class="si">}</span><span class="s2">&#39;,&#39;</span><span class="si">{</span><span class="n">schemaB</span><span class="si">}</span><span class="s2">&#39;,&#39;</span><span class="si">{</span><span class="n">tableB</span><span class="si">}</span><span class="s2">&#39;,</span><span class="si">{</span><span class="n">radius</span><span class="si">}</span><span class="s2">, &quot;</span> \
                <span class="sa">f</span><span class="s2">&quot;&#39;</span><span class="si">{</span><span class="n">results_table_name</span><span class="si">}</span><span class="s2">&#39;) FROM dual;&quot;</span>

        <span class="n">name</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">results_table_name</span><span class="p">)</span>

        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">launch_job_async</span><span class="p">(</span><span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                     <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                     <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span>
                                     <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                     <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                                     <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span>
                                     <span class="n">upload_resource</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                                     <span class="n">upload_table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.launch_job">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.launch_job">[docs]</a>
    <span class="k">def</span> <span class="nf">launch_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">upload_resource</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">upload_table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launches a synchronous job</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query : str, mandatory</span>
<span class="sd">            query to be executed</span>
<span class="sd">        name : str, optional, default None</span>
<span class="sd">            custom name defined by the user for the job that is going to be created</span>
<span class="sd">        output_file : str, optional, default None</span>
<span class="sd">            file name where the results are saved if dumpToFile is True.</span>
<span class="sd">            If this parameter is not provided, the jobid is used instead</span>
<span class="sd">        output_format : str, optional, default &#39;votable&#39;</span>
<span class="sd">            results format. Available formats are: &#39;votable&#39;, &#39;votable_plain&#39;,</span>
<span class="sd">             &#39;fits&#39;, &#39;csv&#39;, &#39;ecsv&#39; and &#39;json&#39;, default is &#39;votable&#39;.</span>
<span class="sd">             Returned results for &#39;votable&#39; and &#39;fits&#39; formats are compressed</span>
<span class="sd">             gzip files.</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        dump_to_file : bool, optional, default &#39;False&#39;</span>
<span class="sd">            if True, the results are saved in a file instead of using memory</span>
<span class="sd">        upload_resource : str, optional, default None</span>
<span class="sd">            resource to be uploaded to UPLOAD_SCHEMA</span>
<span class="sd">        upload_table_name : str, optional, default None</span>
<span class="sd">            resource temporary table name associated to the uploaded resource.</span>
<span class="sd">            This argument is required if upload_resource is provided.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Job object</span>
<span class="sd">        &quot;&quot;&quot;</span>

        <span class="k">return</span> <span class="n">TapPlus</span><span class="o">.</span><span class="n">launch_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                  <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                  <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                                  <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                  <span class="n">dump_to_file</span><span class="o">=</span><span class="n">dump_to_file</span><span class="p">,</span>
                                  <span class="n">upload_resource</span><span class="o">=</span><span class="n">upload_resource</span><span class="p">,</span>
                                  <span class="n">upload_table_name</span><span class="o">=</span><span class="n">upload_table_name</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.launch_job_async">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.launch_job_async">[docs]</a>
    <span class="k">def</span> <span class="nf">launch_job_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="p">,</span> <span class="o">*</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_file</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">output_format</span><span class="o">=</span><span class="s2">&quot;votable&quot;</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">dump_to_file</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                         <span class="n">upload_resource</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">upload_table_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                         <span class="n">autorun</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Launches an asynchronous job</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        query : str, mandatory</span>
<span class="sd">            query to be executed</span>
<span class="sd">        name : str, optional, default None</span>
<span class="sd">            custom name defined by the user for the job that is going to be created</span>
<span class="sd">        output_file : str, optional, default None</span>
<span class="sd">            file name where the results are saved if dumpToFile is True.</span>
<span class="sd">            If this parameter is not provided, the jobid is used instead</span>
<span class="sd">        output_format : str, optional, default &#39;votable&#39;</span>
<span class="sd">            results format. Available formats are: &#39;votable&#39;, &#39;votable_plain&#39;,</span>
<span class="sd">             &#39;fits&#39;, &#39;csv&#39; and &#39;json&#39;, default is &#39;votable&#39;.</span>
<span class="sd">             Returned results for &#39;votable&#39; &#39;ecsv&#39; and &#39;fits&#39; format are compressed</span>
<span class="sd">             gzip files.</span>
<span class="sd">        verbose : bool, optional, default &#39;False&#39;</span>
<span class="sd">            flag to display information about the process</span>
<span class="sd">        dump_to_file : bool, optional, default &#39;False&#39;</span>
<span class="sd">            if True, the results are saved in a file instead of using memory</span>
<span class="sd">        background : bool, optional, default &#39;False&#39;</span>
<span class="sd">            when the job is executed in asynchronous mode, this flag specifies</span>
<span class="sd">            whether the execution will wait until results are available</span>
<span class="sd">        upload_resource : str, optional, default None</span>
<span class="sd">            resource to be uploaded to UPLOAD_SCHEMA</span>
<span class="sd">        upload_table_name : str, optional, default None</span>
<span class="sd">            resource temporary table name associated to the uploaded resource.</span>
<span class="sd">            This argument is required if upload_resource is provided.</span>
<span class="sd">        autorun : boolean, optional, default True</span>
<span class="sd">            if &#39;True&#39;, sets &#39;phase&#39; parameter to &#39;RUN&#39;,</span>
<span class="sd">            so the framework can start the job.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        A Job object</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span> <span class="n">TapPlus</span><span class="o">.</span><span class="n">launch_job_async</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">query</span><span class="o">=</span><span class="n">query</span><span class="p">,</span>
                                        <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">,</span>
                                        <span class="n">output_file</span><span class="o">=</span><span class="n">output_file</span><span class="p">,</span>
                                        <span class="n">output_format</span><span class="o">=</span><span class="n">output_format</span><span class="p">,</span>
                                        <span class="n">verbose</span><span class="o">=</span><span class="n">verbose</span><span class="p">,</span>
                                        <span class="n">dump_to_file</span><span class="o">=</span><span class="n">dump_to_file</span><span class="p">,</span>
                                        <span class="n">background</span><span class="o">=</span><span class="n">background</span><span class="p">,</span>
                                        <span class="n">upload_resource</span><span class="o">=</span><span class="n">upload_resource</span><span class="p">,</span>
                                        <span class="n">upload_table_name</span><span class="o">=</span><span class="n">upload_table_name</span><span class="p">,</span>
                                        <span class="n">autorun</span><span class="o">=</span><span class="n">autorun</span><span class="p">)</span></div>


<div class="viewcode-block" id="GaiaClass.get_status_messages">
<a class="viewcode-back" href="../../../api/astroquery.gaia.GaiaClass.html#astroquery.gaia.GaiaClass.get_status_messages">[docs]</a>
    <span class="k">def</span> <span class="nf">get_status_messages</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Retrieve the messages to inform users about</span>
<span class="sd">        the status of Gaia TAP</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">try</span><span class="p">:</span>
            <span class="n">subContext</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">GAIA_MESSAGES</span>
            <span class="n">connHandler</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_TapPlus__getconnhandler</span><span class="p">()</span>
            <span class="n">response</span> <span class="o">=</span> <span class="n">connHandler</span><span class="o">.</span><span class="n">execute_tapget</span><span class="p">(</span><span class="n">subContext</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
            <span class="k">if</span> <span class="n">response</span><span class="o">.</span><span class="n">status</span> <span class="o">==</span> <span class="mi">200</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">Iterable</span><span class="p">):</span>
                    <span class="k">for</span> <span class="n">line</span> <span class="ow">in</span> <span class="n">response</span><span class="p">:</span>

                        <span class="k">try</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;=&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
                        <span class="k">except</span> <span class="ne">ValueError</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="n">e</span><span class="p">)</span>
                        <span class="k">except</span> <span class="ne">IndexError</span><span class="p">:</span>
                            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Archive down for maintenance&quot;</span><span class="p">)</span>

        <span class="k">except</span> <span class="ne">OSError</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Status messages could not be retrieved&quot;</span><span class="p">)</span></div>
</div>



<span class="n">Gaia</span> <span class="o">=</span> <span class="n">GaiaClass</span><span class="p">()</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, The Astroquery Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 11 Dec 2023. <br/>
  </p>
</footer>
  </body>
</html>