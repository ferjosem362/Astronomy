<!DOCTYPE html>

<html lang="en" data-content_root="../../../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>astroquery.ipac.irsa.most &#8212; astroquery v0.4.7.dev9024</title>
    <link rel="stylesheet" type="text/css" href="../../../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/bootstrap-astropy.css?v=9d21690f" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/graphviz.css?v=eafc0fe6" />
    <link rel="stylesheet" type="text/css" href="../../../../_static/plot_directive.css" />
    
    <script src="../../../../_static/jquery.js?v=5d32c60e"></script>
    <script src="../../../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
    <script src="../../../../_static/documentation_options.js?v=4195d067"></script>
    <script src="../../../../_static/doctools.js?v=888ff710"></script>
    <script src="../../../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script type="text/javascript" src="../../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../../_static/copybutton.js"></script>
    <link rel="icon" href="../../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" />
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>

  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../../index.html"><span id="logotext1">astro</span><span id="logotext2">query</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../../../index.html">astroquery v0.4.7.dev9024</a>
	 &#187;
      </li>
      <li><a href="../../../index.html" >Module code</a> &#187;</li>
      <li><a href="../irsa.html" accesskey="U">astroquery.ipac.irsa</a> &#187;</li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for astroquery.ipac.irsa.most</h1><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">tarfile</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="kn">from</span> <span class="nn">bs4</span> <span class="kn">import</span> <span class="n">BeautifulSoup</span>

<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">votable</span><span class="p">,</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>

<span class="kn">from</span> <span class="nn">astroquery.query</span> <span class="kn">import</span> <span class="n">BaseQuery</span>
<span class="kn">from</span> <span class="nn">astroquery.utils</span> <span class="kn">import</span> <span class="n">class_or_instance</span>
<span class="kn">from</span> <span class="nn">astroquery.exceptions</span> <span class="kn">import</span> <span class="n">InvalidQueryError</span><span class="p">,</span> <span class="n">NoResultsWarning</span>

<span class="kn">from</span> <span class="nn">.</span> <span class="kn">import</span> <span class="n">conf</span>


<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Most&quot;</span><span class="p">,</span> <span class="s2">&quot;MostClass&quot;</span><span class="p">]</span>


<div class="viewcode-block" id="MostClass">
<a class="viewcode-back" href="../../../../api/astroquery.ipac.irsa.MostClass.html#astroquery.ipac.irsa.MostClass">[docs]</a>
<span class="k">class</span> <span class="nc">MostClass</span><span class="p">(</span><span class="n">BaseQuery</span><span class="p">):</span>
    <span class="n">URL</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">most_server</span>
    <span class="n">TIMEOUT</span> <span class="o">=</span> <span class="n">conf</span><span class="o">.</span><span class="n">timeout</span>

    <span class="k">def</span> <span class="nf">_validate_name_input_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate required parameters when ``input_type=&#39;name_input&#39;``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params : `dict`</span>
<span class="sd">            Dictionary of query parameters to validate.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the input does not have the minimum required parameters set to</span>
<span class="sd">            an at least truthy value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;obj_name&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When input type is &#39;name_input&#39; key &#39;obj_name&#39; is required.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_nafid_input_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate required parameters when ``input_type=&#39;naifid_input&#39;``.</span>


<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params : `dict`</span>
<span class="sd">            Dictionary of query parameters to validate.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the input does not have the minimum required parameters set to</span>
<span class="sd">            an at least truthy value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;obj_nafid&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When input type is &#39;nafid_input&#39; key &#39;obj_nafid&#39; is required.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_mpc_input_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate required parameters when ``input_type=&#39;mpc_input&#39;``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params : `dict`</span>
<span class="sd">            Dictionary of query parameters to validate.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the input does not have the minimum required parameters set to</span>
<span class="sd">            an at least truthy value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj_type</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;obj_type&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When input type is &#39;mpc_input&#39; key &#39;obj_type&#39; is required.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Asteroid&quot;</span><span class="p">,</span> <span class="s2">&quot;Comet&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Object type is case sensitive and must be one of: `Asteroid` or `Comet`&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;mpc_data&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When input type is &#39;mpc_input&#39; key &#39;mpc_data&#39; is required.&quot;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">_validate_manual_input_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate required parameters when ``input_type=&#39;manual_input&#39;``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params : `dict`</span>
<span class="sd">            Dictionary of query parameters to validate.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the input does not have the minimum required parameters set to</span>
<span class="sd">            an at least truthy value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">obj_type</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;obj_type&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">obj_type</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When input type is &#39;manual_input&#39; key &#39;obj_type&#39; is required.&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obj_type</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Asteroid&quot;</span><span class="p">,</span> <span class="s2">&quot;Comet&quot;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Object type is case sensitive and must be one of: &#39;Asteroid&#39; or &#39;Comet&#39;&quot;</span><span class="p">)</span>

        <span class="c1"># MOST will always require at least the distance and eccentricity</span>
        <span class="c1"># distance param is named differently in cases of asteroids and comets</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;eccentricity&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When input_type is &#39;manual_input&#39;, &#39;eccentricity&#39; is required.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">obj_type</span> <span class="o">==</span> <span class="s2">&quot;Asteroid&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;semimajor_axis&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When obj_type is &#39;Asteroid&#39;, &#39;semimajor_axis&#39; is required.&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">obj_type</span> <span class="o">==</span> <span class="s2">&quot;Comet&quot;</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;perih_dist&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;When obj_type is &#39;Comet&#39;, &#39;perih_dist&#39; is required.&quot;</span><span class="p">)</span>

        <span class="c1"># This seemingly can be whatever</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;body_designation&quot;</span><span class="p">,</span> <span class="kc">False</span><span class="p">):</span>
            <span class="n">params</span><span class="p">[</span><span class="s2">&quot;body_designation&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Test&quot;</span><span class="o">+</span><span class="n">params</span><span class="p">[</span><span class="s2">&quot;obj_type&quot;</span><span class="p">]</span>

    <span class="k">def</span> <span class="nf">_validate_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">params</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Validate the minimum required set of parameters, for a given input</span>
<span class="sd">        type, are at least truthy.</span>

<span class="sd">        These include the keys ``catalog``, ``input_type``, ``output_mode`` and</span>
<span class="sd">        ``ephem_step`` in addition to keys required by the specified input type.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        params : `dict`</span>
<span class="sd">            Dictionary of query parameters to validate.</span>

<span class="sd">        Raises</span>
<span class="sd">        ------</span>
<span class="sd">        ValueError</span>
<span class="sd">            If the input does not have the minimum required parameters set to</span>
<span class="sd">            an at least truthy value.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;catalog&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Which catalog is being queried is always required.&quot;</span><span class="p">)</span>

        <span class="n">input_type</span> <span class="o">=</span> <span class="n">params</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;input_type&quot;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">input_type</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;Input type is always required.&quot;</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;name_input&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_name_input_type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;nafid_input&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_nafid_input_type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;mpc_input&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_mpc_input_type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">input_type</span> <span class="o">==</span> <span class="s2">&quot;manual_input&quot;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">_validate_manual_input_type</span><span class="p">(</span><span class="n">params</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
                <span class="s2">&quot;Unrecognized &#39;input_type&#39;. Expected `name_input`, `nafid_input` &quot;</span>
                <span class="sa">f</span><span class="s2">&quot;`mpc_input` or `manual_input`, got </span><span class="si">{</span><span class="n">input_type</span><span class="si">}</span><span class="s2"> instead.&quot;</span>
            <span class="p">)</span>

    <span class="k">def</span> <span class="nf">_parse_full_regular_response</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">response</span><span class="p">,</span> <span class="n">withTarballs</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Parses the response when output type is set to ``&quot;Regular&quot;`` or ``&quot;Full&quot;``.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        response : `requests.models.Response`</span>
<span class="sd">            Query response.</span>
<span class="sd">        withTarballs : `bool`, optional</span>
<span class="sd">            Parse the links to FITS and region tarballs from the response. By</span>
<span class="sd">            default, set to False.</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        retdict : `dict`</span>
<span class="sd">            Dictionary containing the keys ``results``, ``metadata`` and ``region``.</span>
<span class="sd">            Optionally can contain keys ``fits_tarball`` and ``region_tarball``.</span>
<span class="sd">            The ``results`` and ``metadata`` are an `astropy.table.Table` object</span>
<span class="sd">            containing the links to image and region files and minimum object</span>
<span class="sd">            metadata, while ``metadata`` contains the image metadata and object</span>
<span class="sd">            positions. The ``region`` key contains a link to the DS9 region file</span>
<span class="sd">            representing the matched object trajectory and search boxes. When</span>
<span class="sd">            existing, ``fits_tarball`` and ``region_tarball`` are links to the</span>
<span class="sd">            tarball archives of the fits and region images.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">retdict</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">html</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;html5lib&quot;</span><span class="p">)</span>
        <span class="n">download_tags</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;a&quot;</span><span class="p">,</span> <span class="n">string</span><span class="o">=</span><span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">&quot;.*Download.*&quot;</span><span class="p">))</span>

        <span class="c1"># this is &quot;Download Results Table (above)&quot;</span>
        <span class="n">results_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">download_tags</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="s2">&quot;href&quot;</span><span class="p">])</span>
        <span class="n">retdict</span><span class="p">[</span><span class="s2">&quot;results&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">results_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;ipac&quot;</span><span class="p">)</span>

        <span class="c1"># this is &quot;Download Image Metadata with Matched Object position Table&quot;</span>
        <span class="n">imgmet_response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">download_tags</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;href&quot;</span><span class="p">])</span>
        <span class="n">retdict</span><span class="p">[</span><span class="s2">&quot;metadata&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">imgmet_response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;ipac&quot;</span><span class="p">)</span>

        <span class="c1"># this is &quot;Download DS9 Region File with the Orbital Path&quot;, it&#39;s a link</span>
        <span class="c1"># to a DS9 region file</span>
        <span class="c1"># regions_response = self._request(&quot;GET&quot;, download_tags[2][&quot;href&quot;])</span>
        <span class="n">retdict</span><span class="p">[</span><span class="s2">&quot;region&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">download_tags</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>

        <span class="k">if</span> <span class="n">withTarballs</span><span class="p">:</span>
            <span class="n">retdict</span><span class="p">[</span><span class="s2">&quot;fits_tarball&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">download_tags</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">][</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>
            <span class="n">retdict</span><span class="p">[</span><span class="s2">&quot;region_tarball&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">download_tags</span><span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">][</span><span class="s2">&quot;href&quot;</span><span class="p">]</span>

        <span class="k">return</span> <span class="n">retdict</span>

<div class="viewcode-block" id="MostClass.list_catalogs">
<a class="viewcode-back" href="../../../../api/astroquery.ipac.irsa.MostClass.html#astroquery.ipac.irsa.MostClass.list_catalogs">[docs]</a>
    <span class="nd">@class_or_instance</span>
    <span class="k">def</span> <span class="nf">list_catalogs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Returns a list of queriable catalogs.&quot;&quot;&quot;</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">conf</span><span class="o">.</span><span class="n">most_interface_url</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>

        <span class="n">html</span> <span class="o">=</span> <span class="n">BeautifulSoup</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">,</span> <span class="s2">&quot;html5lib&quot;</span><span class="p">)</span>
        <span class="n">catalog_dropdown_options</span> <span class="o">=</span> <span class="n">html</span><span class="o">.</span><span class="n">find</span><span class="p">(</span><span class="s2">&quot;select&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">find_all</span><span class="p">(</span><span class="s2">&quot;option&quot;</span><span class="p">)</span>

        <span class="n">catalogs</span> <span class="o">=</span> <span class="p">[</span><span class="n">tag</span><span class="o">.</span><span class="n">string</span> <span class="k">for</span> <span class="n">tag</span> <span class="ow">in</span> <span class="n">catalog_dropdown_options</span><span class="p">]</span>

        <span class="c1"># The Internal-Use-only datasets are free to search in MOST.</span>
        <span class="c1"># The way it is supposed to work is that the images will not be accessible.</span>
        <span class="k">if</span> <span class="s2">&quot;--- Internal use only:&quot;</span> <span class="ow">in</span> <span class="n">catalogs</span><span class="p">:</span>
            <span class="n">catalogs</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="s2">&quot;--- Internal use only:&quot;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">catalogs</span></div>


<div class="viewcode-block" id="MostClass.get_images">
<a class="viewcode-back" href="../../../../api/astroquery.ipac.irsa.MostClass.html#astroquery.ipac.irsa.MostClass.get_images">[docs]</a>
    <span class="k">def</span> <span class="nf">get_images</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;wise_merge&quot;</span><span class="p">,</span> <span class="n">input_mode</span><span class="o">=</span><span class="s2">&quot;name_input&quot;</span><span class="p">,</span> <span class="n">ephem_step</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span>
                   <span class="n">obs_begin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obs_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_nafid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">mpc_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">body_designation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eccentricity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">inclination</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">arg_perihelion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ascend_node</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">semimajor_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                   <span class="n">mean_anomaly</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">perih_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">perih_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                   <span class="n">save</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">savedir</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Gets images containing the specified object or orbit.</span>

<span class="sd">        Parameters are case sensitive.</span>
<span class="sd">        See module help for more details.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        catalog : str</span>
<span class="sd">            Catalog to query.</span>
<span class="sd">            Required.</span>
<span class="sd">            Default ``&quot;wise_merge&quot;``.</span>
<span class="sd">        input_mode : str</span>
<span class="sd">            Input mode. One of ``&quot;name_input&quot;``, ``&quot;naifid_input&quot;``,</span>
<span class="sd">            ``&quot;mpc_input&quot;`` or ``&quot;manual_input&quot;``.</span>
<span class="sd">            Required.</span>
<span class="sd">            Default: ``&quot;name_input&quot;``.</span>
<span class="sd">        ephem_step : 0.25,</span>
<span class="sd">            Size of the steps (in days) at which the object ephemeris is evaluated.</span>
<span class="sd">            Required.</span>
<span class="sd">            Default: 0.25</span>
<span class="sd">        obs_begin : str or None</span>
<span class="sd">            UTC of the start of observations in ``YYYY-MM-DD``. When ``None``</span>
<span class="sd">            queries all availible data in the catalog which can be slow.</span>
<span class="sd">            Optional.</span>
<span class="sd">            Default: ``None``.</span>
<span class="sd">        obs_end : str or None</span>
<span class="sd">            UTC of the end of observations in ``YYYY-MM-DD``. When ``None``</span>
<span class="sd">            queries all availible data in the catalog, can be slow.</span>
<span class="sd">            Optional.</span>
<span class="sd">            Default: ``None``.</span>
<span class="sd">        obj_name : str or None</span>
<span class="sd">            Object name.</span>
<span class="sd">            Required when input mode is ``&quot;name_input&quot;``.</span>
<span class="sd">        obj_nafid : str or None</span>
<span class="sd">            Object NAIFD.</span>
<span class="sd">            Required when input mode is ``&quot;naifid_input&quot;``.</span>
<span class="sd">        obj_type : str or None</span>
<span class="sd">            Object type, ``&quot;Asteroid&quot;`` or ``Comet``.</span>
<span class="sd">            Required when input mode is ``&quot;mpc_input&quot;`` or ``&quot;manual_input&quot;``.</span>
<span class="sd">        mpc_data : str or None</span>
<span class="sd">            MPC formatted object string.</span>
<span class="sd">            Required when input mode is ``&quot;mpc_input&quot;``.</span>
<span class="sd">        body_designation : str or None</span>
<span class="sd">            Name of the object described by the given orbital parameters. Does</span>
<span class="sd">            not have to be a real name. Will default to ``&quot;TestAsteroid&quot;`` or</span>
<span class="sd">            ``&quot;TestComet&quot;`` depending on selected object type.</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        epoch : str or None</span>
<span class="sd">            Epoch in MJD.</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        eccentricity : float or None</span>
<span class="sd">            Eccentricity (0-1).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        inclination : float or None</span>
<span class="sd">            Inclination (0-180 degrees).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        arg_perihelion : str or None</span>
<span class="sd">            Argument of perihelion (0-360 degrees).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        ascend_node : float or None</span>
<span class="sd">            Longitude of the ascending node (0-360).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        semimajor_axis : float or None</span>
<span class="sd">            Semimajor axis (AU).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;`` and object type is</span>
<span class="sd">            ``&quot;Asteroid&quot;``.</span>
<span class="sd">        mean_anomaly : str or None</span>
<span class="sd">            Mean anomaly (degrees).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;`` and object type is</span>
<span class="sd">            ``&quot;Asteroid&quot;``.</span>
<span class="sd">        perih_dist : float or None</span>
<span class="sd">            Perihelion distance (AU).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;`` and object type is</span>
<span class="sd">            ``&quot;Comet&quot;``.</span>
<span class="sd">        perih_time : str or None</span>
<span class="sd">            Perihelion time (YYYY+MM+DD+HH:MM:SS).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;`` and object type is</span>
<span class="sd">            ``&quot;Comet&quot;``.</span>
<span class="sd">        get_query_payload : bool</span>
<span class="sd">            Return the query parameters as a dictionary. Useful for debugging.</span>
<span class="sd">            Optional.</span>
<span class="sd">            Default: ``False``</span>
<span class="sd">        save : bool</span>
<span class="sd">            Whether to save the file to a local directory.</span>
<span class="sd">        savedir : str</span>
<span class="sd">            The location to save the local file if you want to save it</span>
<span class="sd">            somewhere other than `~astroquery.query.BaseQuery.cache_location`</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        images : list</span>
<span class="sd">            A list of `~astropy.io.fits.HDUList` objects.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># We insist on output_mode being regular so that it executes quicker,</span>
        <span class="c1"># and we insist on tarballs so the download is quicker. We ignore</span>
        <span class="c1"># whatever else user provides, but leave the parameters as arguments to</span>
        <span class="c1"># keep the same signatures for doc purposes.</span>
        <span class="n">queryres</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">query_object</span><span class="p">(</span>
            <span class="n">catalog</span><span class="o">=</span><span class="n">catalog</span><span class="p">,</span>
            <span class="n">input_mode</span><span class="o">=</span><span class="n">input_mode</span><span class="p">,</span>
            <span class="n">obs_begin</span><span class="o">=</span><span class="n">obs_begin</span><span class="p">,</span>
            <span class="n">obs_end</span><span class="o">=</span><span class="n">obs_end</span><span class="p">,</span>
            <span class="n">ephem_step</span><span class="o">=</span><span class="n">ephem_step</span><span class="p">,</span>
            <span class="n">obj_name</span><span class="o">=</span><span class="n">obj_name</span><span class="p">,</span>
            <span class="n">obj_nafid</span><span class="o">=</span><span class="n">obj_nafid</span><span class="p">,</span>
            <span class="n">obj_type</span><span class="o">=</span><span class="n">obj_type</span><span class="p">,</span>
            <span class="n">mpc_data</span><span class="o">=</span><span class="n">mpc_data</span><span class="p">,</span>
            <span class="n">body_designation</span><span class="o">=</span><span class="n">body_designation</span><span class="p">,</span>
            <span class="n">epoch</span><span class="o">=</span><span class="n">epoch</span><span class="p">,</span>
            <span class="n">eccentricity</span><span class="o">=</span><span class="n">eccentricity</span><span class="p">,</span>
            <span class="n">inclination</span><span class="o">=</span><span class="n">inclination</span><span class="p">,</span>
            <span class="n">arg_perihelion</span><span class="o">=</span><span class="n">arg_perihelion</span><span class="p">,</span>
            <span class="n">ascend_node</span><span class="o">=</span><span class="n">ascend_node</span><span class="p">,</span>
            <span class="n">semimajor_axis</span><span class="o">=</span><span class="n">semimajor_axis</span><span class="p">,</span>
            <span class="n">mean_anomaly</span><span class="o">=</span><span class="n">mean_anomaly</span><span class="p">,</span>
            <span class="n">perih_dist</span><span class="o">=</span><span class="n">perih_dist</span><span class="p">,</span>
            <span class="n">perih_time</span><span class="o">=</span><span class="n">perih_time</span><span class="p">,</span>
            <span class="n">get_query_payload</span><span class="o">=</span><span class="n">get_query_payload</span><span class="p">,</span>
            <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;Regular&quot;</span><span class="p">,</span>
            <span class="n">with_tarballs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
        <span class="p">)</span>

        <span class="k">if</span> <span class="n">queryres</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="c1"># A warning will already be issued by query_object so no need to</span>
            <span class="c1"># raise a new one here.</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;GET&quot;</span><span class="p">,</span> <span class="n">queryres</span><span class="p">[</span><span class="s2">&quot;fits_tarball&quot;</span><span class="p">],</span>
                                 <span class="n">save</span><span class="o">=</span><span class="n">save</span><span class="p">,</span> <span class="n">savedir</span><span class="o">=</span><span class="n">savedir</span><span class="p">)</span>

        <span class="n">archive</span> <span class="o">=</span> <span class="n">tarfile</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileobj</span><span class="o">=</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
        <span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">name</span> <span class="ow">in</span> <span class="n">archive</span><span class="o">.</span><span class="n">getnames</span><span class="p">():</span>
            <span class="k">if</span> <span class="s2">&quot;.fits&quot;</span> <span class="ow">in</span> <span class="n">name</span><span class="p">:</span>
                <span class="n">fileobj</span> <span class="o">=</span> <span class="n">archive</span><span class="o">.</span><span class="n">extractfile</span><span class="p">(</span><span class="n">name</span><span class="p">)</span>
                <span class="n">fitsfile</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fileobj</span><span class="p">)</span>
                <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">fitsfile</span><span class="p">)</span>

        <span class="k">return</span> <span class="n">images</span></div>


<div class="viewcode-block" id="MostClass.query_object">
<a class="viewcode-back" href="../../../../api/astroquery.ipac.irsa.MostClass.html#astroquery.ipac.irsa.MostClass.query_object">[docs]</a>
    <span class="nd">@class_or_instance</span>
    <span class="k">def</span> <span class="nf">query_object</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">catalog</span><span class="o">=</span><span class="s2">&quot;wise_merge&quot;</span><span class="p">,</span> <span class="n">input_mode</span><span class="o">=</span><span class="s2">&quot;name_input&quot;</span><span class="p">,</span> <span class="n">output_mode</span><span class="o">=</span><span class="s2">&quot;Regular&quot;</span><span class="p">,</span>
                     <span class="n">ephem_step</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">with_tarballs</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">obs_begin</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obs_end</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">obj_name</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_nafid</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">obj_type</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mpc_data</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">body_designation</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">epoch</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">eccentricity</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">inclination</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">arg_perihelion</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ascend_node</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">semimajor_axis</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">mean_anomaly</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                     <span class="n">perih_dist</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">perih_time</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">get_query_payload</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Query the MOST interface using specified parameters and/or default</span>
<span class="sd">        query values.</span>

<span class="sd">        MOST service takes an object/orbit, depending on the input mode,</span>
<span class="sd">        evaluates its ephemerides in the, in the given time range, and returns</span>
<span class="sd">        a combination of image identifiers, image metadata and/or ephemerides</span>
<span class="sd">        depending on the output mode.</span>

<span class="sd">        The required and optional query parameters vary depending on the query</span>
<span class="sd">        input type. Provided parameters that do not match the given input type</span>
<span class="sd">        will be ignored. Certain parameters are always required input to the</span>
<span class="sd">        service. For these the provided default values match the defaults of</span>
<span class="sd">        the online MOST interface.</span>

<span class="sd">        Parameters are case sensitive.</span>
<span class="sd">        See module help for more details.</span>

<span class="sd">        Parameters</span>
<span class="sd">        ----------</span>
<span class="sd">        catalog : str</span>
<span class="sd">            Catalog to query.</span>
<span class="sd">            Required.</span>
<span class="sd">            Default ``&quot;wise_merge&quot;``.</span>
<span class="sd">        input_mode : str</span>
<span class="sd">            Input mode. One of ``&quot;name_input&quot;``, ``&quot;naifid_input&quot;``,</span>
<span class="sd">            ``&quot;mpc_input&quot;`` or ``&quot;manual_input&quot;``.</span>
<span class="sd">            Required.</span>
<span class="sd">            Default: ``&quot;name_input&quot;``.</span>
<span class="sd">        output_mode : str</span>
<span class="sd">            Output mode. One of ``&quot;Regular&quot;``, ``&quot;Full&quot;``, ``&quot;Brief&quot;``,</span>
<span class="sd">            ``&quot;Gator&quot;`` or ``&quot;VOTable&quot;``.</span>
<span class="sd">            Required.</span>
<span class="sd">            Default: ``&quot;Regular&quot;``</span>
<span class="sd">        ephem_step : 0.25,</span>
<span class="sd">            Size of the steps (in days) at which the object ephemeris is evaluated.</span>
<span class="sd">            Required.</span>
<span class="sd">            Default: 0.25</span>
<span class="sd">        with_tarballs : bool</span>
<span class="sd">            Return links to tarballs of found FITS and Region files.</span>
<span class="sd">            Optional, only when output mode is ``&quot;Regular&quot;`` or ``&quot;Full&quot;``.</span>
<span class="sd">            Default: ``False``</span>
<span class="sd">        obs_begin : str or None</span>
<span class="sd">            UTC of the start of observations in ``YYYY-MM-DD``. When ``None``</span>
<span class="sd">            queries all availible data in the catalog which can be slow.</span>
<span class="sd">            Optional.</span>
<span class="sd">            Default: ``&quot;None&quot;``.</span>
<span class="sd">        obs_end : str or None</span>
<span class="sd">            UTC of the end of observations in ``YYYY-MM-DD``. When ``None``</span>
<span class="sd">            queries all availible data in the catalog, can be slow.</span>
<span class="sd">            Optional.</span>
<span class="sd">            Default: ``None``</span>
<span class="sd">        obj_name : str or None</span>
<span class="sd">            Object name.</span>
<span class="sd">            Required when input mode is ``&quot;name_input&quot;``.</span>
<span class="sd">        obj_nafid : str or None</span>
<span class="sd">            Object NAIFD</span>
<span class="sd">            Required when input mode is ``&quot;naifid_input&quot;``.</span>
<span class="sd">        obj_type : str or None</span>
<span class="sd">            Object type, ``&quot;Asteroid&quot;`` or ``Comet``</span>
<span class="sd">            Required when input mode is ``&quot;mpc_input&quot;`` or ``&quot;manual_input&quot;``.</span>
<span class="sd">        mpc_data : str or None</span>
<span class="sd">            MPC formatted object string.</span>
<span class="sd">            Required when input mode is ``&quot;mpc_input&quot;``.</span>
<span class="sd">        body_designation : str or None</span>
<span class="sd">            Name of the object described by the given orbital parameters. Does</span>
<span class="sd">            not have to be a real name. Will default to ``&quot;TestAsteroid&quot;`` or</span>
<span class="sd">            ``&quot;TestComet&quot;`` depending on selected object type.</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        epoch : str or None</span>
<span class="sd">            Epoch in MJD.</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        eccentricity : float or None</span>
<span class="sd">            Eccentricity (0-1).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        inclination : float or None</span>
<span class="sd">            Inclination (0-180 degrees).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        arg_perihelion : str or None</span>
<span class="sd">            Argument of perihelion (0-360 degrees).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        ascend_node : float or None</span>
<span class="sd">            Longitude of the ascending node (0-360).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;``.</span>
<span class="sd">        semimajor_axis : float or None</span>
<span class="sd">            Semimajor axis (AU).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;`` and object type is</span>
<span class="sd">            ``&quot;Asteroid&quot;``.</span>
<span class="sd">        mean_anomaly : str or None</span>
<span class="sd">            Mean anomaly (degrees).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;`` and object type is</span>
<span class="sd">            ``&quot;Asteroid&quot;``.</span>
<span class="sd">        perih_dist : float or None</span>
<span class="sd">            Perihelion distance (AU).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;`` and object type is</span>
<span class="sd">            ``&quot;Comet&quot;``.</span>
<span class="sd">        perih_time : str or None</span>
<span class="sd">            Perihelion time (YYYY+MM+DD+HH:MM:SS).</span>
<span class="sd">            Required when input mode is ``&quot;manual_input&quot;`` and object type is</span>
<span class="sd">            ``&quot;Comet&quot;``.</span>
<span class="sd">        get_query_payload : bool</span>
<span class="sd">            Return the query parameters as a dictionary. Useful for debugging.</span>
<span class="sd">            Optional.</span>
<span class="sd">            Default: ``False``</span>

<span class="sd">        Returns</span>
<span class="sd">        -------</span>
<span class="sd">        query_results : `~astropy.table.Table`, `~astropy.io.votable.tree.VOTableFile` or `dict`</span>
<span class="sd">            Results of the query. Content depends on the selected output mode.</span>
<span class="sd">            In ``&quot;Full&quot;`` or ``&quot;Regular&quot;`` output mode returns a dictionary</span>
<span class="sd">            containing at least ``results``, ``metadata`` and ``region`` keys,</span>
<span class="sd">            and optionally ``fits_tarball`` and ``region_tarball`` keys. When</span>
<span class="sd">            in ``&quot;Brief&quot;`` or ``&quot;Gator&quot;`` an `~astropy.table.Table` object and</span>
<span class="sd">            in ``&quot;VOTable&quot;`` an `~astropy.io.votable.tree.VOTableFile`. See</span>
<span class="sd">            module help for more details on the content of these tables.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="c1"># This is a map between the keyword names used by the MOST cgi-bin</span>
        <span class="c1"># service and their more user-friendly names. For example,</span>
        <span class="c1"># input_type -&gt; input_mode or fits_region_files --&gt; with tarballs</span>
        <span class="n">qparams</span> <span class="o">=</span> <span class="p">{</span>
            <span class="s2">&quot;catalog&quot;</span><span class="p">:</span> <span class="n">catalog</span><span class="p">,</span>
            <span class="s2">&quot;input_type&quot;</span><span class="p">:</span> <span class="n">input_mode</span><span class="p">,</span>
            <span class="s2">&quot;output_mode&quot;</span><span class="p">:</span> <span class="n">output_mode</span><span class="p">,</span>
            <span class="s2">&quot;obs_begin&quot;</span><span class="p">:</span> <span class="n">obs_begin</span><span class="p">,</span>
            <span class="s2">&quot;obs_end&quot;</span><span class="p">:</span> <span class="n">obs_end</span><span class="p">,</span>
            <span class="s2">&quot;ephem_step&quot;</span><span class="p">:</span> <span class="n">ephem_step</span><span class="p">,</span>
            <span class="s2">&quot;fits_region_files&quot;</span><span class="p">:</span> <span class="s2">&quot;on&quot;</span> <span class="k">if</span> <span class="n">with_tarballs</span> <span class="k">else</span> <span class="s2">&quot;&quot;</span><span class="p">,</span>
            <span class="s2">&quot;obj_name&quot;</span><span class="p">:</span> <span class="n">obj_name</span><span class="p">,</span>
            <span class="s2">&quot;obj_nafid&quot;</span><span class="p">:</span> <span class="n">obj_nafid</span><span class="p">,</span>
            <span class="s2">&quot;obj_type&quot;</span><span class="p">:</span> <span class="n">obj_type</span><span class="p">,</span>
            <span class="s2">&quot;mpc_data&quot;</span><span class="p">:</span> <span class="n">mpc_data</span><span class="p">,</span>
            <span class="s2">&quot;body_designation&quot;</span><span class="p">:</span> <span class="n">body_designation</span><span class="p">,</span>
            <span class="s2">&quot;epoch&quot;</span><span class="p">:</span> <span class="n">epoch</span><span class="p">,</span>
            <span class="s2">&quot;eccentricity&quot;</span><span class="p">:</span> <span class="n">eccentricity</span><span class="p">,</span>
            <span class="s2">&quot;inclination&quot;</span><span class="p">:</span> <span class="n">inclination</span><span class="p">,</span>
            <span class="s2">&quot;arg_perihelion&quot;</span><span class="p">:</span> <span class="n">arg_perihelion</span><span class="p">,</span>
            <span class="s2">&quot;ascend_node&quot;</span><span class="p">:</span> <span class="n">ascend_node</span><span class="p">,</span>
            <span class="s2">&quot;semimajor_axis&quot;</span><span class="p">:</span> <span class="n">semimajor_axis</span><span class="p">,</span>
            <span class="s2">&quot;mean_anomaly&quot;</span><span class="p">:</span> <span class="n">mean_anomaly</span><span class="p">,</span>
            <span class="s2">&quot;perih_dist&quot;</span><span class="p">:</span> <span class="n">perih_dist</span><span class="p">,</span>
            <span class="s2">&quot;perih_time&quot;</span><span class="p">:</span> <span class="n">perih_time</span><span class="p">,</span>
        <span class="p">}</span>

        <span class="k">if</span> <span class="n">get_query_payload</span><span class="p">:</span>
            <span class="k">return</span> <span class="n">qparams</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">_validate_input</span><span class="p">(</span><span class="n">qparams</span><span class="p">)</span>
        <span class="n">response</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_request</span><span class="p">(</span><span class="s2">&quot;POST&quot;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">URL</span><span class="p">,</span>
                                 <span class="n">data</span><span class="o">=</span><span class="n">qparams</span><span class="p">,</span> <span class="n">timeout</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">TIMEOUT</span><span class="p">)</span>

        <span class="c1"># service unreachable or some other reason</span>
        <span class="n">response</span><span class="o">.</span><span class="n">raise_for_status</span><span class="p">()</span>

        <span class="c1"># MOST will not raise an bad response if the query is bad because they</span>
        <span class="c1"># are not a REST API</span>
        <span class="k">if</span> <span class="s2">&quot;MOST: *** error:&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">InvalidQueryError</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">)</span>

        <span class="c1"># presume that response is HTML to simplify conditions</span>
        <span class="k">if</span> <span class="s2">&quot;Number of Matched Image Frames   = 0&quot;</span> <span class="ow">in</span> <span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Number of Matched Image Frames   = 0&quot;</span><span class="p">,</span> <span class="n">NoResultsWarning</span><span class="p">)</span>
            <span class="k">return</span> <span class="kc">None</span>

        <span class="k">if</span> <span class="n">qparams</span><span class="p">[</span><span class="s2">&quot;output_mode&quot;</span><span class="p">]</span> <span class="ow">in</span> <span class="p">(</span><span class="s2">&quot;Brief&quot;</span><span class="p">,</span> <span class="s2">&quot;Gator&quot;</span><span class="p">):</span>
            <span class="k">return</span> <span class="n">Table</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">text</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;ipac&quot;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">qparams</span><span class="p">[</span><span class="s2">&quot;output_mode&quot;</span><span class="p">]</span> <span class="o">==</span> <span class="s2">&quot;VOTable&quot;</span><span class="p">:</span>
            <span class="n">matches</span> <span class="o">=</span> <span class="n">votable</span><span class="o">.</span><span class="n">parse</span><span class="p">(</span><span class="n">io</span><span class="o">.</span><span class="n">BytesIO</span><span class="p">(</span><span class="n">response</span><span class="o">.</span><span class="n">content</span><span class="p">))</span>
            <span class="k">if</span> <span class="n">matches</span><span class="o">.</span><span class="n">get_table_by_index</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="o">.</span><span class="n">nrows</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Number of Matched Image Frames   = 0&quot;</span><span class="p">,</span> <span class="n">NoResultsWarning</span><span class="p">)</span>
                <span class="k">return</span> <span class="n">Table</span><span class="p">()</span>
            <span class="k">return</span> <span class="n">matches</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_parse_full_regular_response</span><span class="p">(</span><span class="n">response</span><span class="p">,</span> <span class="n">qparams</span><span class="p">[</span><span class="s2">&quot;fits_region_files&quot;</span><span class="p">])</span></div>
</div>



<span class="n">Most</span> <span class="o">=</span> <span class="n">MostClass</span><span class="p">()</span>
</pre></div>

            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right"> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2023, The Astroquery Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 7.2.6. &nbsp;
    Last built 11 Dec 2023. <br/>
  </p>
</footer>
  </body>
</html>